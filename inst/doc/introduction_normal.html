<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Yue Li" />

<meta name="date" content="2017-12-21" />

<title>RBesT for a Normal Endpoint</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">RBesT for a Normal Endpoint</h1>
<h4 class="author"><em>Yue Li</em></h4>
<h4 class="date"><em>2017-12-21</em></h4>



<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{RBest for a Normal Endpoint}
-->
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The R Bayesian evidence synthesis Tools (RBesT) have been created to facilitate the use of historical information in clinical trials. Once relevant historical information has been identified, RBesT supports the derivation of informative priors via the Meta-Analytic-Predictive (MAP) approach [1], the evaluation of the trial’s operating characteristics, and the data analysis with the actual trial data. RBesT has been developed for endpoints from a number of well known distributions. Here we consider an example for a normally distributed response variable.</p>
</div>
<div id="trial-design-with-historical-control-data" class="section level1">
<h1>Trial Design with Historical Control Data</h1>
<div id="historical-data" class="section level2">
<h2>Historical Data</h2>
<p>Let’s look at the Crohn’s disease example data [2] (data-set <code>crohn</code> in RBesT). The primary endpoint is the change from baseline in Crohn’s Disease Activity Index (CDAI), which is assumed to be normally distributed. Note that for CDAI, an improved outcome corresponds to a negative change from baseline.</p>
<p>First from historical studies we get the estimated standard deviation of the response variable as <span class="math inline">\(\sigma\)</span> = 88, which is used to obtain the standard errors of the effect estimates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span>crohn
crohn_sigma &lt;-<span class="st"> </span><span class="dv">88</span>
dat<span class="op">$</span>y.se &lt;-<span class="st"> </span>crohn_sigma<span class="op">/</span><span class="kw">sqrt</span>(dat<span class="op">$</span>n)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">study</th>
<th align="right">n</th>
<th align="right">y</th>
<th align="right">y.se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Gastr06</td>
<td align="right">74</td>
<td align="right">-51</td>
<td align="right">10.229792</td>
</tr>
<tr class="even">
<td align="left">AIMed07</td>
<td align="right">166</td>
<td align="right">-49</td>
<td align="right">6.830125</td>
</tr>
<tr class="odd">
<td align="left">NEJM07</td>
<td align="right">328</td>
<td align="right">-36</td>
<td align="right">4.858987</td>
</tr>
<tr class="even">
<td align="left">Gastr01a</td>
<td align="right">20</td>
<td align="right">-47</td>
<td align="right">19.677398</td>
</tr>
<tr class="odd">
<td align="left">APhTh04</td>
<td align="right">25</td>
<td align="right">-90</td>
<td align="right">17.600000</td>
</tr>
<tr class="even">
<td align="left">Gastr01b</td>
<td align="right">58</td>
<td align="right">-54</td>
<td align="right">11.554966</td>
</tr>
</tbody>
</table>
</div>
<div id="derivation-of-map-prior" class="section level2">
<h2>Derivation of MAP Prior</h2>
<p>The MAP prior can be derived with the function <strong><code>gMAP</code></strong>. The between-trial heterogeneity parameter <span class="math inline">\(\tau\)</span> governs how much information will be shared from the historical trials into the design and analysis of the future trials. In the normal case with a known sampling standard deviation <span class="math inline">\(\sigma\)</span>, the amount of borrowing from historical data depends on the ratio <span class="math inline">\(\tau/\sigma\)</span>. A conservative choice for the prior on <span class="math inline">\(\tau\)</span> is a <strong><code>HalfNormal(0,</code></strong> <span class="math inline">\(\sigma/2\)</span><strong><code>)</code></strong> distribution. For the prior on the intercept we recommend a “unit-information” prior [3] which is set to a precision corresponding to a single observation and centered here at no change from baseline. Please refer to the help page <strong><code>?gMAP</code></strong> for detailed information. The <strong><code>set.seed</code></strong> function is used to make the results exactly reproducible.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RBesT)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
map_mcmc &lt;-<span class="st"> </span><span class="kw">gMAP</span>(<span class="kw">cbind</span>(y, y.se) <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>study, 
                 <span class="dt">weights=</span>n,<span class="dt">data=</span>dat,
                 <span class="dt">family=</span>gaussian,
                 <span class="dt">beta.prior=</span><span class="kw">cbind</span>(<span class="dv">0</span>, crohn_sigma),
                 <span class="dt">tau.dist=</span><span class="st">&quot;HalfNormal&quot;</span>,<span class="dt">tau.prior=</span><span class="kw">cbind</span>(<span class="dv">0</span>,crohn_sigma<span class="op">/</span><span class="dv">2</span>))
<span class="kw">print</span>(map_mcmc)</code></pre></div>
<pre><code>## Generalized Meta Analytic Predictive Prior Analysis
## 
## Call:  gMAP(formula = cbind(y, y.se) ~ 1 | study, family = gaussian, 
##     data = dat, weights = n, tau.dist = &quot;HalfNormal&quot;, tau.prior = cbind(0, 
##         crohn_sigma/2), beta.prior = cbind(0, crohn_sigma))
## 
## Exchangeability tau strata: 1 
## Prediction tau stratum    : 1 
## Maximal Rhat              : 1 
## Estimated reference scale : 88 
## 
## Between-trial heterogeneity of tau prediction stratum
##  mean    sd  2.5%   50% 97.5% 
## 14.40  9.68  1.37 12.50 37.80 
## 
## MAP Prior MCMC sample
##  mean    sd  2.5%   50% 97.5% 
## -49.8  19.3 -91.5 -48.5 -11.4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## a graphical representation is also available
pl &lt;-<span class="st"> </span><span class="kw">plot</span>(map_mcmc)

## a number of plots are immediately defined
<span class="kw">names</span>(pl)</code></pre></div>
<pre><code>## [1] &quot;densityThetaStar&quot;     &quot;densityThetaStarLink&quot; &quot;forest_model&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## forest plot with model estimates
<span class="kw">print</span>(pl<span class="op">$</span>forest_model)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="approximation-of-map-prior-using-a-mixture-distribution" class="section level2">
<h2>Approximation of MAP Prior using a Mixture Distribution</h2>
<p>Next, the MCMC MAP prior from the previous section is converted to a parametric representation with the <strong><code>automixfit</code></strong> function. This function fits a parametric mixture representation using expectation-maximization (EM). The number of mixture components is chosen automatically using AIC. One can also specify the number of components for the mixture via <strong><code>mixfit</code></strong> function and compare with the <strong><code>automixfit</code></strong> outcome.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">map &lt;-<span class="st"> </span><span class="kw">automixfit</span>(map_mcmc)
<span class="kw">print</span>(map)</code></pre></div>
<pre><code>## EM for Normal Mixture Model
## Log-Likelihood = -17088.78
## 
## Univariate normal mixture
## Reference scale: 88
## Mixture Components:
##   comp1         comp2         comp3         comp4        
## w   0.445244690   0.323850313   0.228686552   0.002218445
## m -50.818252222 -46.646179345 -52.165836131 -56.942654609
## s  15.560760529   6.972283136  30.812391797 111.491581418</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## check accuracy of mixture fit
<span class="kw">plot</span>(map)<span class="op">$</span>mix</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAm4AAAGACAMAAAAj0B5OAAAA21BMVEUAAAAAADoAAGYAOjoAOmYAOpAAW5YAZmYAZrYzMzM6AAA6ADo6AGY6ZmY6kLY6kNtNTU1NTW5NTY5NbqtNjshkl7FmAABmADpmOgBmZgBmkJBmtrZmtttmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQZgCQkGaQtpCQ27aQ29uQ2/+rbk2ryKur5P+2ZgC2tma2/7a2/9u2///Ijk3I///bkDrbtmbb/9vb///kq27k///r6+v/tmb/yI7/25D/29v/5Kv//7b//8j//9v//+T///92FvxGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAU6klEQVR4nO2da4PbxBWGtaGo7hK6acFLW3AvtM0W6FJcGnAJxLhZFv3/X1TNVaNZXUaXczTSvO+HeB1Lj2eOHo008i0rEIQt2dINQFIKdEMYA90QxkA3hDHQDWEMdEMYA90QxkA3hDGubqdM5up+FOny/JX+6/Hu3dfeg0dDfbzLdvUFqvXao1v2rHdJSW4kPnx0/3C7a2+hXMYuYBZqWbDs0E1fUwTA4E665Q+3N95zh/Q+IMcsM9SjqFRA64rWMhCmQbcsO4whnZ516qYrcLn2dTv1SxTeMkluJJZ+zKnb5b3+nTJEt5De9+dclmann0EVKsijhXVTXT+HtdVPZ+GOz36voKdf1jZp33p+y4JG3ibiufy/Ebq1P8lx1/6YBZhlXN362zo8Z7sfntRufQwa36LQrXTjldphRJvLmp3EVjb3L9c3Z/HHWe9BYncqly8PkuX/qoX/KXtxdg/Lx2f/lnce7z6+VaObrNA5+0SvJ9YQm8c8ncZ6LTvLKprHyrX+qw8c8ukP8r++k8STfrqdAsg/SpvOds3XVRdtW6Vuj3f6yczo5jyN0yxneKtKVS0onug/7aObbq+qmosVrF87dWgre+G25lidaBzVrdpxmlcuG6H7q8pQLzVt2nQ7mYPX490712Uj7f3L9fvXZWM/v1bj91mf7hndxMLfySNa7TTw+OxruWNfnn+tdRNb1crh6iafzmC9lsnl7GPyOavNpv7QxLLChbPXX64Poq7vXJs1TQulpKatD7JtpvSVbnZBp1nO0OW1whJ/8bud136jm2mv1q3Cataur+wydjVHt5MzrLWs/HD7vlsGr9S0aTyYmqJfrsVfasc198uTr0Mh95XLtazbQf2/XNssLB6Qu6bpe2mwPPqcdg9aN7HLySFIrVfppggW67ZMcqrH5LSjLKpo1E1RWHJFPJr1JKDcjW/U8sZ3w9FtLQnybxVHt51ZzWnW0e4CTqn0gg+3am+w7TfnnpnSzbbXVE0a+u7rar3ususnNqs5B1N17nZTb1h95XKRnVuGeqlp0zRV0AUXLXf3dnVfNuzhVh4QdN1U0VThzKFKP2BSbpuzfPxgpTDTB183VSOLLWp/lJzqMbWsAMoJiEg1VTjp0Uqvp44ackNJZdUmM126MT3cHavdvNKtehqnWSdnQHBLVS3o7C5PdDMmCpbx9+pe7Z9K3a6yyweq1Rzd9MzUHHGbVq6XwS81bRp0k098ubajumycvV/tmGIbnitDXW1EL2qTyLJvD7cHMe2vdHu4VZvN082eVTlDvKtb9Vi1lqqx2RZ6KLuptoJ5QlVZvabTJb2YHBrsbuKcu+mnqTXLOVDXSqUWPBSdM1PTXq2bJJ2v7qszzu6y6+c1q9V002vtWlfWO6Eug19q2jSduxWq8IfCVcPcH62bmMuddg7zrK5rDNGtXh9HN1VaPWyppcvW2WNpk25ulyrdPrGjSqhufqmCdDPt7dGtrewS1q6bOpC2rRyhbqoralRX1TH36013rPJ18w+mxbmcqjnbpfznH2b/VidC1SbzZK3NTKvHXN3kk4hzb6vb+eoLe9nBbLxdobZEtUPYLomoTbNzVqrrVmuW2cR+qdSCN4V7XaX5ulvZ3o6DaVfZ9ROb1dyRdmcL3rayOpjWy8CVVt12ct8yxa7u15uuzqzlicbJTHWqqYI+SyiUTpfrPzx/5ZzQX91Lltyjj2piV20yi3VbdlaXXMxj7mgizwL1gKfGiHICVl2r0Odu7lTB7aJuq+zW0T0C13WrNcucu/mlEguWdw+1qYKnm22vrlrTVKGr7Lp9T6cK5jnPmdtBX7f6jKleatq06Gbm9FUNzX2v32dzBizO/G4q3fQDZs85qgnYrhrC1KZVl1z0pQBx4UDv+xVWtcycaR/cx2rzWae1J7Xi0blCdVKX1d7XhzD3+obTVtkmu4881a3WrGpm6pfKLNh7IcS0tfFCSGfZZarVqoOpPl9zrxM91e0dpwx+qWnTops8a7i6ryZx9r7fb9m/g1pCXXFzzr/sOC23zSk7VLrJKaDYAeX+J+pcrm11q7CqZaokun3mMWfzytLu9H8pYuEez/V1txv3Mq/tkm2r6pa5dNWgm9Os6hjulcou2HuZd6erpmYt1WXej+1JRXvZbSHUiYM/M+1aWV3trjZUvdS02fA7QtwrFZUccyXkRdORefpS18z4HSW+M9vVrTpxFDnPPfMKeM10eNSZ/pF2rIFu80ddBXAS8o6hAaEZ3KpzOsJAt/mjXgRy8vDRrH7MbK+JPacjDHRDEgl0QxgD3RDGQDeEMdANYQx0QxgD3RDGOLr9CkGo0qBbj5lvZjI8No4G5Xk+C2d6YuPMAIJuPijfQzcyEHTzQdCNEATdfBB0IwRBNx8E3QhB0M0HQTdCEHTzQdCNEATdfBB0IwRBNx8E3QhB0M0HQTdCEHTzQdCNEATdfBB0IwRBNx8E3QhB0M0HQTdCEHTzQdCNENSk25ukU+q2dBO2G4xuPgijGyEIuvkg6EYIgm4+CLoRgqCbD4JuhCDo5oOgGyEIuvkg6EYIgm4+CLoRgqCbD4JuhCDo5oOgGyEIuvkg6EYIgm4+CLoRgqCbD4JuhCDo5oBy8f0g0I0QBN0cUL7fQzdSEHRzQNCNGgTdHBB0owZBNwcE3ahB0M2mnCdAN2IQdLMpPdtnGXSjBEE3m9Iz8btn0I0QBN1stG4ZdKMDQTcbcSiFbrQg6GZjdMugGxkIutmoMzfoRgmCbja5PJBCN0oQdLOBbvQg6GYD3ehB0M0mM7pN/Tm62DoG3WLkCNv2eQHdCEHQzQa60YOgm43SLYduhCDoZqN0208/eYutY9AtRo7WbfrwFlvHoFuMHOhGD4JuJhl0owdBNxP5VjfoRguCbibQjQEE3Uxc3ab5FlnHoFuMHKvbHrqRgaCbCXRjAOFnPHSymm5Lt2arweimI98OgtGNGATddKAbBwi66UA3DhB004FuHCDopgPdOEDQTQe6cYCgm05dt0m+xdUx6BYhJ3N0m/qqaVQdm5ED3WbjqK8+gm7EIOimAt1YQNBNBbqxgKCbCnRjAUE3FejGAoJuKtCNBQTdVHzdpvgWVcdm5EC32Tg13Sa+rhBVx2bkQLfZONCNBQTdZDLoxgKCbjKZ+v0O6EYMgm4y0I0HBN1koBsPCLrJQDceEHSTgW48IOgmA914QNBN5qluE3yLqWNzcqDbTJzM023aq6YRdWxWDnSbiSPtgm70IOgmAt2YQNBNBLoxgaCbCHRjAkE3EejGBIJuItCNCQTdRKAbEwi6iUA3JhB0K/SbK6EbAwi6FfrraKAbAwi6FS26jfctno7Ny4Fu83Ce6jbpPSHxdGxeDnSbhwPduEDQrYBufCD8jMcb+RMe+/yNr9vSrdpiMLoVGN34QNCtgG58IOhWQDc+EHQroBsfCLoVRQ7duEDQzXzJPXRjAEE3dSxt0G20b9F0bGYOdJuF06TblOEtmo7NzIFus3CgGxsIukE3RhB0g26MIOhmdMuhGz0Iuhnd9tCNHgTdoBsjCLqpq7zQjQUE3dRPKkA3FhB0g26MIOjWrttY32Lp2Nwc6DYHp1m3CR81jaVjc3Og2xwc6MYHgm7QjREE3aAbIwi6QTdGEHTLoBsfCLrJd45DNx4QdINujCDoBt0YQdCtQ7eRvkXSsdk50G0GTptu4181jaRjs3Og2wwc6MYIgm7QjREE3aAbIwi6QTdGEHSDboyg5HXLoBsjCLqJV0yhGxMIukE3RhB0g26MoMR1y3PoxglKXbc9dOMEJf4zHj26Ld28zQWjW5du44a3GDpGwcHBdCqnS7fR73iLoWMUHOg2lZNn0I0TBN2yPXRjA0E36MYIgm7QjREE3aAbIwi6QTdGEHSDbowg6AbdGEGJ65b16DbKtxg6RsGBblM5+iJvs25jX6SPoWMUHOg2lQPdeEHQDboxgqAbdGMEQTfoxgiCbtCNEQTdoBsjCLpBN0YQdINujKC0dct6dRvjWwQdI+FAt2kc+4ppi24jXzVdvmM0HOg2jQPduEHQDboxgqAbdGMEQTfoxgiCbtCNEZS0bhl0YwalrtseunGCoBt0YwRBN+jGCIJu0I0RBN16dBvh2/Ido+FAt0mcrFe3ArrNC0pcN98zT7dxR9PFO0bEgW6TOP26jXvH2+IdI+JAt0kc6MYOgm7QjREE3aAbIwi6QTdGUMI/45GH6bZ0MzeVhEe3LEy34cPb0h2j4uBgOoXT9Lu5vm6jjqZLd4yKA92mcKAbPwi6QTdGEHSDbowg6AbdGEHp6pZBN35Q0ro99Qy60YKgG3RjBEG3Xt0G+7aRAlGAoFu3bmPeYLmRAlGAktWt+WeaoRstKGXdGjyDbrQg6AbdGEHQDboxgqAbdGMEQTfoxghKVbeWHzKFbrSghHVr8gy60YKgW79uQ33bRIFoQNCtR7cRr5puokA0IOgG3RhBierW9utEzbrleU7doDVwoNtYTtt3QDfrVt5QN2gNHOg2lgPdlgFBN+jGCEpTt9YfVGjWLYNuM4GS1a3Zswbdcug2Hwi6QTdGEHSDbowg6AbdGEFJ6tb+DffQjRaUqm4tnkE3WhB0C9Etg27zgFLUreNrK5t020O32UCJ6tbmGXSjBUE36MYIgm7QjRGUoG5dX+wG3WhBaerW6hl0owUl+DMeY3TDj3nME4xu/boN/fDf2gtECEpPt85v2oJutKAkdWv3DLrRgqAbdGMEJadb95eDQDdaUIq6dXjWqtsQ39ZdIFIQdAvQbeAn6dddIFJQarr1fHweutGCEtQth26LgRLUrcsz6EYLSky3vs8zt+s2wLc1F4gYlJ5unZ616DZseFtzgYhB0A26MYLS0q33E3/QjRaUnG7dnkE3WhB0g26MoKR06//EX4du4b6tt0DkoNR06/GsTbd8yBvI11sgchB0g26MoJR0C/gIFnSjBSWmW59nXboFn7yttkD0oFR0Ez+NMEW3IXPTVRaIB5SMbvqbjKDboqC0dOv1DLrRgtLRLehDCp26hfq2ygLxgJLSrd+zdt3k3DRscrrKAvGAoNsA3QK/M3WVBeIBJaNb2IcUoBstKA3d8txOFKboFnild4UF4gIlols1URitW/j3bq2wQFyghHQL8Qy60YKg2xDdwi6FrLBAXKBEdAt913iXbsFfFbLCAnGB0tEtyDPoRgtKQ7fgt/H26Rbk2woLxAVKRrcwzzp1C33ddIUF4gIloVv4+yqhGy0oFd0CPevVLcS39RWIDZSCbgPe6NatW+DwtroC8YES0S3Us37dAnxbXYH4QAn8jMeQN7r16JbjBz2mJYHRbchbQQJ06x/e1lYgRhB0G6Rb0Nnb2grECNq+boPe6AbdaEGb100e/mbVrde3dRWIFZSCbsWMuoW8cLquArGCtq5bRqBbn2+rKhAvKAHdill1Czh7W1WBeEEb102duQX8ksIg3Xp8W1OBmEHb182MbXPp1n/2tqYCMYO2rVtGpFsmP9zV9smFFRWIG7Rp3eQlN3MonU23vb620vqp0/UUiB20dd1CFRqi2x66jc3mdHOOcRmhbhl0G5Pt6WYt8N7mNqNuOXQbme3qpk7cyHTLoNuIbFq3QQoNWVYfp1k7tjwHuj3lSN3UV9AQ6tb5BTVxF2hR0EZ1MxcriHTLO78xJO4CLQraqG4Nr8zPqdu+87WsuAu0KGibutWu79Lo1vHWkLgLtChok7o1fox5bt3ax7e4C7QoaIu6NX+udHbdWn2Lu0CLgjaoW8sH/ebXzR5PvVfr4y7QoqDt6db2URgC3Yxv+R66hWU7uskhRgrQ/FEYAt321dMRdiwaDnRzOLmZkrZ8NoFEN/WE0C00m9Ity/TFfj7dquck61g0HOjmcMyG3/PqZg6odB2LhgPdKo6STU5Jmz8KQ6KbfCbtuZ2exlmgKEAb0c2RbbJCI5atH1FjLFAkoC3opl3r+bJnSt32pgnzdiwyDnSz41r/91OS6lYJl3d8RGtg4ir0LKDV6VbbmFnmbOVldauEC/0tI6IC0XGS1M19c3jQUZRLN3MVzjmsLlEgOk6qumVuSk40urlD3HTloNs8TxrCaT4Fyrzs5WWPiHSr5qnucZ6iQPycTeu23zeepDmqsSg0ZFl7/pj7yo0a66DbPE/qc+z+7wwE+X7fsMmqAYNLoQnLtrff6ytboRcHLa9b+0ZpHdIWVGj4soO6R1noGEADdWs8SnAkLoWGLCsGYv3RrTTSNWoP/BkPXt3yjYazhvzJ82E/44EgVHmqW1/6zu24E1t7omtQbO0poNucia1BsbWngG5zJrYGxdaeYpBuCDI10A1hDHRDGAPdEMZAN4QxAbq9/eOLFy+L4qe/vvjgB3uzaN7++duo2iMSSzuKOMuj06/bT3/7qnj7p69+/vJl8f2Hhb5ZND+++O23RUTtEYmlHUWc5THp1+1H0dpvXv7092/FbqNv6BvWnm9+86+yAfG0RyaWdkRaHpOwc7dyhHv7lx+cG+JW9UQUMKb2iCZF0g6RCMtjEqTbz19+Wvz4gWy4vqFuVndEPWNqT5lY2iESYXlMunX75sWLD8Xp5qdFHLuLak+Mu28s7RCJsDwmQTPTcl4a1cnA2/hOTmJph0iE5THp103ZJg+ocqrz6fJTHVHAmNpTFNG0QyTC8pj06/b9C5GXMV3IifHCUiztKOIsjw5eVUAYA90QxkA3hDHQDWEMdEMYA90QxkA3hDHQDWEMdOvLKcuyq/uehS7v9S2BiEC3npyevSqKc3boXgq6hQW6defxTop2fPd152LQLSzQrTuPdzfmz8t1eVi9Kc36vPzjRtw7lHc+y7JSRaHb412WiaEQaQ9068lZKCbycHuQh9bLdanXSTgm7zx79Xi3E7qJm+LUMwqmHujWGzFX2BXF/4RIpVaX64MY6Q7OnfL2vfuzGNmkk0hroFtIHm7FqHWWc1R5mmb+kbelY+XtSX2p3k0/LeFAt6CUOj3cXt1bw5p0w3G0P9CtO3rKKQ6WcoDzRzd5MH3+Sjzee3EOgW59OQqLxDRA6HS5fqKbM1UofYRz3YFufTmZM7Jjeeb2hTxuugfTz+Q8wlwIgW3dgW6Tgsu7wwLdJgW6DQt0mxToNizQDWEMdEMYA90QxkA3hDHQDWEMdEMYA90QxvwfmnYY/vfsRloAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## choose the number of components manually
map_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">mixfit</span>(map_mcmc, <span class="dt">Nc =</span> <span class="dv">2</span>)
<span class="kw">print</span>(map_<span class="dv">2</span>)</code></pre></div>
<pre><code>## EM for Normal Mixture Model
## Log-Likelihood = -17137.46
## 
## Univariate normal mixture
## Reference scale: 88
## Mixture Components:
##   comp1       comp2      
## w   0.6499541   0.3500459
## m -48.0554471 -53.0074800
## s  10.1482970  29.3143195</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(map_<span class="dv">2</span>)<span class="op">$</span>mix</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="effective-sample-size-ess" class="section level2">
<h2>Effective Sample Size (ESS)</h2>
<p>The main advantage of using historical information is the possibility to reduce the number of control patients, as the informative prior is effectively equivalent to a certain number of control patients. This is called the effective sample size (ESS) and can be calculated in RBesT with the <strong><code>ess</code></strong> function.</p>
<p>Note, however, that various methods to calculate ESS have been proposed, and that they can give fairly different answers. The default moment-based approach yields conservative ESS, while the Morita et. al [4] approach normally gives an over optimistic ESS. From experience, a realistic ESS can be obtained by applying the Morita et. al method to a MAP approximation with few mixture components.</p>
<p>In the study protocol of this Crohn’s disease data example, the moment-based ESS of 20 was used to reduce the planned sample size of the control group.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ess</span>(map)</code></pre></div>
<pre><code>## Using default prior reference scale 88</code></pre>
<pre><code>## [1] 21</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ess</span>(map,   <span class="dt">method=</span><span class="st">&quot;morita&quot;</span>)</code></pre></div>
<pre><code>## Using default prior reference scale 88</code></pre>
<pre><code>## [1] 101</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ess</span>(map_<span class="dv">2</span>, <span class="dt">method=</span><span class="st">&quot;morita&quot;</span>)</code></pre></div>
<pre><code>## Using default prior reference scale 88</code></pre>
<pre><code>## [1] 65</code></pre>
</div>
<div id="robustification-of-map-prior" class="section level2">
<h2>Robustification of MAP Prior</h2>
<p>We recommend robustifying [5] the prior with the <strong><code>robustify</code></strong> function, which protects against type-I error inflation in presence of prior-data conflict. For the normal case we strongly recommend explicitly choosing the mean of the robust component. We use <span class="math inline">\(-50\)</span> consistent with the mean of the MAP prior. Furthermore, 20% probability is used for the additional robust (unit-information) mixture component. The choice of such probability reflects the confidence about the validitiy of the model assumptions, i.e. the possibility of a non-exchangable control group to be enrolled per inclusion/exclusion criteria in the current trial as compared to the historical control group population. Note that robustification decreases the ESS (numbers not shown).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## add a 20% non-informative mixture component
map_robust &lt;-<span class="st"> </span><span class="kw">robustify</span>(map, <span class="dt">weight=</span><span class="fl">0.2</span>, <span class="dt">mean=</span><span class="op">-</span><span class="dv">50</span>)</code></pre></div>
<pre><code>## Using default prior reference scale 88</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(map_robust)</code></pre></div>
<pre><code>## Univariate normal mixture
## Reference scale: 88
## Mixture Components:
##   comp1         comp2         comp3         comp4         robust       
## w   0.356195752   0.259080251   0.182949242   0.001774756   0.200000000
## m -50.818252222 -46.646179345 -52.165836131 -56.942654609 -50.000000000
## s  15.560760529   6.972283136  30.812391797 111.491581418  88.000000000</code></pre>
</div>
<div id="operating-characteristics-of-design-options" class="section level2">
<h2>Operating Characteristics of Design Options</h2>
<p>Typically, operating characteristics are required to evaluate the proposed design or compare a few design options. RBesT requires the input of decision rules via <strong><code>decision2S</code></strong> function and then calculates the operating characteristics with the <strong><code>oc2S</code></strong> function. The calculation is expedited based on analytic expressions. In the following we compare a few design options, which differ in the choice of the control priors and the sample size of the control group for the planned trial. There may be other design factors (such as the outcome standard deviation), which should be considered when comparing design options. Such factors are not considered here for simplicity purpose.</p>
<div id="decision-rules" class="section level3">
<h3>Decision Rules</h3>
<p>Consider this 2-arm design of placebo (with an informative prior) against an experimental treatment. The dual-criterion for success is defined as follows: <span class="math display">\[
\begin{align*}
\textrm{Criterion 1:} &amp;  \Pr(y_{act} - y_{pbo} \lt 0) &amp;&gt; 0.95 \\
\textrm{Criterion 2:} &amp; \Pr(y_{act} - y_{pbo} \lt -50) &amp;&gt; 0.50.
\end{align*}
\]</span></p>
<p>Equivalently, the second criterion requires that the posterior median difference exceeds -50. The dual-criteria account for statistical significance as well as clinical relevance. Note that a negative change from baseline in CDAI corresponds to improvement.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## dual decision criteria
## pay attention to &quot;lower.tail&quot; argument and the order of active and pbo
poc &lt;-<span class="st"> </span><span class="kw">decision2S</span>(<span class="dt">pc=</span><span class="kw">c</span>(<span class="fl">0.95</span>,<span class="fl">0.5</span>), <span class="dt">qc=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="dv">50</span>), <span class="dt">lower.tail=</span><span class="ot">TRUE</span>)
<span class="kw">print</span>(poc)</code></pre></div>
<pre><code>## 2 sample decision function
## Conditions for acceptance:
## P(x1 - x2 &lt;= 0) &gt; 0.95
## P(x1 - x2 &lt;= -50) &gt; 0.5
## Link: identity</code></pre>
</div>
<div id="design-options" class="section level3">
<h3>Design Options</h3>
<p>For the active group we use the same weakly informative (unit-information) prior as used in the robustification step of the MAP prior. Also, we set up the few design options with different choices of control prior and different sizes of control group.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## set up prior for active group
weak_prior &lt;-<span class="st"> </span><span class="kw">mixnorm</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">50</span>,<span class="dv">1</span>), <span class="dt">sigma=</span>crohn_sigma, <span class="dt">param =</span> <span class="st">'mn'</span>)
n_act &lt;-<span class="st"> </span><span class="dv">40</span>
n_pbo &lt;-<span class="st"> </span><span class="dv">20</span>

## four designs
## &quot;b&quot; means a balanced design, 1:1
## &quot;ub&quot; means 40 in active and 20 in placebo
design_noprior_b  &lt;-<span class="st"> </span><span class="kw">oc2S</span>(weak_prior, weak_prior, n_act, n_act, poc,
                          <span class="dt">sigma1=</span>crohn_sigma, <span class="dt">sigma2=</span>crohn_sigma)
design_noprior_ub &lt;-<span class="st"> </span><span class="kw">oc2S</span>(weak_prior, weak_prior, n_act, n_pbo, poc,
                          <span class="dt">sigma1=</span>crohn_sigma, <span class="dt">sigma2=</span>crohn_sigma)
design_nonrob_ub  &lt;-<span class="st"> </span><span class="kw">oc2S</span>(weak_prior, map, n_act, n_pbo, poc,
                          <span class="dt">sigma1=</span>crohn_sigma, <span class="dt">sigma2=</span>crohn_sigma)
design_rob_ub     &lt;-<span class="st"> </span><span class="kw">oc2S</span>(weak_prior, map_robust, n_act, n_pbo, poc,
                          <span class="dt">sigma1=</span>crohn_sigma, <span class="dt">sigma2=</span>crohn_sigma)</code></pre></div>
</div>
<div id="type-i-error" class="section level3">
<h3>Type I Error</h3>
<p>The type I can be increased compared to the nominal <span class="math inline">\(\alpha\)</span> level in case of a conflict between the trial data and the prior. The robustified MAP prior can reduce the type I error inflation in this case to a lower level.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the range for true values</span>
cfb_truth &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">120</span>, <span class="op">-</span><span class="dv">40</span>, <span class="dt">by=</span><span class="dv">1</span>)

typeI1 &lt;-<span class="st"> </span><span class="kw">design_noprior_b</span>(cfb_truth, cfb_truth)
typeI2 &lt;-<span class="st"> </span><span class="kw">design_noprior_ub</span>(cfb_truth, cfb_truth)
typeI3 &lt;-<span class="st"> </span><span class="kw">design_nonrob_ub</span>(cfb_truth, cfb_truth)
typeI4 &lt;-<span class="st"> </span><span class="kw">design_rob_ub</span>(cfb_truth, cfb_truth)

ocI &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">cfb_truth=</span>cfb_truth, <span class="dt">typeI=</span>typeI1,
                        <span class="dt">design=</span><span class="st">&quot;40:40 with non-informative priors&quot;</span>),
             <span class="kw">data.frame</span>(<span class="dt">cfb_truth=</span>cfb_truth, <span class="dt">typeI=</span>typeI2,
                        <span class="dt">design=</span><span class="st">&quot;40:20 with non-informative priors&quot;</span>),
             <span class="kw">data.frame</span>(<span class="dt">cfb_truth=</span>cfb_truth, <span class="dt">typeI=</span>typeI3,
                        <span class="dt">design=</span><span class="st">&quot;40:20 with non-robust prior for placebo&quot;</span>),
             <span class="kw">data.frame</span>(<span class="dt">cfb_truth=</span>cfb_truth, <span class="dt">typeI=</span>typeI4,
                        <span class="dt">design=</span><span class="st">&quot;40:20 with robust prior for placebo&quot;</span>)
)
<span class="kw">qplot</span>(cfb_truth, typeI, <span class="dt">data=</span>ocI, <span class="dt">colour=</span>design, <span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Type I Error&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">'True value of change from baseline '</span>, mu[act] <span class="op">==</span><span class="st"> </span>mu[pbo]))) <span class="op">+</span>
<span class="st">        </span><span class="kw">ylab</span>(<span class="st">'Type I error'</span>) <span class="op">+</span>
<span class="st">            </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">legend.position=</span><span class="kw">c</span>(<span class="fl">0.95</span>,<span class="fl">0.85</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="power" class="section level3">
<h3>Power</h3>
<p>The power shows the gain of using an informative prior for the control arm; i.e. 90% power is reached for smaller <span class="math inline">\(\delta\)</span> values compared to the design with weakly informative priors for both arms or the balanced design.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">delta &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">80</span>,<span class="dv">0</span>,<span class="dt">by=</span><span class="dv">1</span>)
m &lt;-<span class="st"> </span><span class="kw">summary</span>(map)[<span class="st">&quot;mean&quot;</span>]
cfb_truth1 &lt;-<span class="st"> </span>m <span class="op">+</span><span class="st"> </span>delta   <span class="co"># active for 1</span>
cfb_truth2 &lt;-<span class="st"> </span>m <span class="op">+</span><span class="st"> </span><span class="dv">0</span><span class="op">*</span>delta <span class="co"># pbo for 2</span>

power1 &lt;-<span class="st"> </span><span class="kw">design_noprior_b</span>(cfb_truth1, cfb_truth2)
power2 &lt;-<span class="st"> </span><span class="kw">design_noprior_ub</span>(cfb_truth1, cfb_truth2)
power3 &lt;-<span class="st"> </span><span class="kw">design_nonrob_ub</span>(cfb_truth1, cfb_truth2)
power4 &lt;-<span class="st"> </span><span class="kw">design_rob_ub</span>(cfb_truth1, cfb_truth2)

ocP &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">cfb_truth1=</span>cfb_truth1, <span class="dt">cfb_truth2=</span>cfb_truth2,
                        <span class="dt">delta=</span>delta, <span class="dt">power=</span>power1,
                        <span class="dt">design=</span><span class="st">&quot;40:40 with non-informative priors&quot;</span>),
             <span class="kw">data.frame</span>(<span class="dt">cfb_truth1=</span>cfb_truth1, <span class="dt">cfb_truth2=</span>cfb_truth2,
                        <span class="dt">delta=</span>delta, <span class="dt">power=</span>power2,
                        <span class="dt">design=</span><span class="st">&quot;40:20 with non-informative priors&quot;</span>),
             <span class="kw">data.frame</span>(<span class="dt">cfb_truth1=</span>cfb_truth1, <span class="dt">cfb_truth2=</span>cfb_truth2,
                        <span class="dt">delta=</span>delta, <span class="dt">power=</span>power3,
                        <span class="dt">design=</span><span class="st">&quot;40:20 with non-robust prior for placebo&quot;</span>),
             <span class="kw">data.frame</span>(<span class="dt">cfb_truth1=</span>cfb_truth1, <span class="dt">cfb_truth2=</span>cfb_truth2,
                        <span class="dt">delta=</span>delta, <span class="dt">power=</span>power4,
                        <span class="dt">design=</span><span class="st">&quot;40:20 with robust prior for placebo&quot;</span>)
)

<span class="kw">qplot</span>(delta, power, <span class="dt">data=</span>ocP, <span class="dt">colour=</span>design, <span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Power&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">'True value of difference (act - pbo)'</span>)<span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">'Power'</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),<span class="fl">0.9</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">80</span>,<span class="dv">0</span>,<span class="dv">20</span>),<span class="op">-</span><span class="dv">70</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="fl">0.9</span>,<span class="dt">linetype=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="op">-</span><span class="dv">70</span>,<span class="dt">linetype=</span><span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">legend.position=</span><span class="kw">c</span>(<span class="fl">0.95</span>,<span class="fl">0.85</span>))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAm4AAAGACAMAAAAj0B5OAAABGlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYAv8QzMzM6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZrY6kJA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmZgBmZjpmZmZmkJBmtrZmtv9uTU1uTW5uTY5ubo5ubqtuq8huq+R8rgCOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQZgCQkDqQkGaQtpCQ27aQ29uQ2/+rbk2rbm6rjk2ryKur5OSr5P+2ZgC2Zjq2kDq225C22/+2/7a2/9u2///HfP/Ijk3I///bkDrb25Db/7bb/9vb///kq27k///r6+v4dm3/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///840VdeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAfGklEQVR4nO2dDX/cxnGHQaXkmVIbt6St0HbbhHaj8mwlpBq5lZxGl7oOT7o6ku6ObPmG7/81um8AFthd7C4W+4ab/8/y3WExmMXdw9kdAAMUJQgUTEXsDoB2SYAbKKAAN1BAAW6ggALcQAEFuIECCnADBRTgBgqoIbitCqK9V6P3BjRxOeBWFKejdwc0bQ3C7dElftkW++9H7g1o4nLArVzg19uTokCv9xeYvVVxVKK3B/Vi/GEFwy6IyRW3bTWNIwsXBSLt+vCoWXx/8YtDiIIgJqfB9ADRhCdwKwTU9eEpCml/hwnce0UXXx+SFY5G7jIoX7mkCih4YaKQFnuvbk8OyuvHL9GyBWaPMIa4vL9goRAEcsINc4RjGtKWUrba//nk6PakGksxkHROBwIRuczdyhZu6N/iAGUGeBHgBpLKGbdqMEUTt9+cnJar/f9CrYzCsiwBNxAnR9yaVAHnoI9xjPvbA7wYH/vA8zbADcTJEbfmiAeGDi2/PSHnGthoegTRDcTLFTc0btKkgQ2sNK7RxRg8wA3ECa4IAQUU4AYKKMANFFCAGyigADdQQAFuoIAC3EABBbiBAqoft5t/eUde7749fvqxWvgJCGQrE9yujj8nuD28Pi8//KrGTbX6Wgt3v5wjrWsHfNu7trv6922v3oAJbm8/+08a3e6ev6sDHeA23B5wMxpMb559LO++e1OygXQNAtnJCrerpxVuPKnmbBvK3x9XIvYQ3SyjG29q7sxQgJtn/77tR8It0NwNcPPs37f9SLg9vD6DzHQEe8BNjxv+1z7uZu3MUICbZ/++7V1x6zU1d2YowM2zf9/2gFtS9oBbSrhBquDZv297wC0pe8ANcAtoD7iNidsMyX5zjQA3z/5924fFbbmkyA1lDlIFz/5924ceTJdLjFw5kDjAzbN/3/Yx5m41cdbMAW6e/fu294Ob9nITRBx5JcyZX6VSDL28BZS6fGemSzau2oyskCp49u/bPvKBkKXdXA5w8+zft30Kx93MiQPcPPv3bZ8CbiU9QmJAHODm2b9v+0Rwq4Ar+4GDzNSzf9/2YXHbbHqsDIAD3Dz7920fOrptNj3ILXVjKuDm2b9v+xiDaV+M689UATfP/n3bx5m79Q6qPXkDpAqe/fu2j5UqmAAnTuMAN8/+fdvHy0z7JnEq4AA3z/5927vh1tRf3XzNbk7Dm+qcmeUNant7xf66ATdVgwFuzX2P7r5F7+rKP5vjbvq8gQMOUgXP/n3bO+HW1M673LRBP42rgQPcPPv3be+EWwNZ5w5IRUEuFSpGeV0ux9kOvKb8aoBbc98jMph+NvyWNJq8oWQRDqKbZ/++7UeKbjhV+NcfnO6A1J82lAQ4SBU8+/dtP9LcrfrUNhU0n/f2pYc4MUsdpNhfN+CmajDKTKv7HuEYZ3QHJA1w6ryBBLi1K3Cxv27ATdVgftwNB7irY9M7ILkAt3aNcLG/bsBN1eDvrMJcO6YqGpZFnTQMVOyvG3BTNXg9iaUhTgVcwZIG+y51O5CoPeDm65xpP3Fy3nBfOica7BT76wbcVA0BLh7vA04a4GhfCHD2vZJ0IDl7wM1rrYIlcJU9Am5YgIv9dQNuqoZApTFWwDX2AwNc7K8bcFM1BKvEsgCOsx8W4GJ/3YCbqiFg4Z8xcC37ISlD7K/b+efKXSng1p+mcsC1+zIgR42NC+Cmagh9s9Qe4mrgun2xzlFj4wK4qRoi3JtXTRwDTuyL5RQuNi6Am6ohzq2g+4GT9cUqwMXGBXBTNcS687gaOIW9zQwuNi6Am6oh3o3uVcBtNnJ7i9OosXEB3FQNMZ+roAROvtg8RY2NC+Cmaoj7GA85b2vVpSKmAS42LoCbqiHyU2OkAa5QXptkyFtsXNr220eX3RWuH79ydJG2UsVNChzpixw4swE1edymrnRxkwDH+qIIcAaHRAC3yEoZNwG4qi+qEXWp4y0d3G5Pir2XCLf7i6LA1F0fFkVxSgZT3PT9k8vrx98f4kWTkhNujrekMVELuMZemTL085YMbrcnR+jfo8v7i4OyXO2/J3O268NT9Fo1XR/uvy9XEwuALrhxt6TBhX+DbkmjFwccZ69MGXoncMngRsZRxBJ5vT05vX5CsUK4VU0IvumlDi64dW5Joy9rHvhr1cC17JUpag9vyeCGAhpi6cnlqiA6KhdFgeIcxqtqogEPcKvV3LShiW7kljTrsTWfSxZuNrJVl8u1xVO2got9dTVu+JUKTdkeXU4at77vxeqWNNwsrvTztGYS4bp9URwTUce3ZKIbGTHR/7Z7HE54UGWD6fbRBHErx4puN9+8Ka8+9zWYUs1lfZECp+YtGdxuTw5YqoBiGWKOMIbY4lMFwK2tZu7GxbnSF24owMn6ouBNDlwyuLUOhOAIty3Ia3Ug5CXgJqi5JU2I6Ib7IjuzJQtwqoQhHdw02jZzuklphONu7JY09d0E/eGmuIOSjDf5gJoDbng6Rw7HTVFpn1WQ2MuAkwc4D88BCWKPD45MlLb8cFMAJy6SDahZ4DZlZYibFDhJgJPwFhsXwE3VkCJuTV+MApx4TVJsXAA3VUPauEkDnLBEuCYpNi6Am6ohcdxkAU4/oMbGBXBTNSSPm2GAa/EWGxfATdWQIm5dexE4McC1eIuNC+CmasgBNylw3QU8b7FxAdxUDXngJpnCCQGO4y02LoCbqiEX3AwCXHNGKzYugJuqIUXcFH0xGVBno3Qgtn32mgJuYoBT8RYbFzP7+4tTcoVSfVWIsIAKX/JL/tNtsFnl/qI40qzZuz0DZ72aBG5igJNM4PAJhjxwWxWnhLDVgWpBLTPcWus7tbtqIrjpAxxJGLLA7fqXX52Wt19e1izxC2iow1ddbvf/58lPJ8WjH5/8IytHvf7038g7UvVQfyoplOQTvnLzFWv+5VeP/vLiZVEcbXFpDil0xe1oez9++r68f8HWQ7r98g/k0k9k8SPqQWN/uS0Ku8rErHDrte8CJ0sYUsJtI4guv3/xHxgo9JPffvFKtmB1RMLd6ogNpodH7GrM6t2CvDTLy2YtDGzVfEouq7s+PMDteNPV4PyXF6+wO7QeDae3J/vvt7QSsW2P/wTEiDvoC8wONwE42YDqtwOj2K+OcPzCoDDcugsQCX9+eYDCTzN3o2Mge4chQGs2y8tmrXYz2gb5xxyhFroKBvoIL8TrkpKdkrrrbJ7ZjfEFZIibMIUTeFun/zxUBNN9K5gJC26//OnLH5/8VLEh4MZAYp9wAWsLN665hdsCD4xslU//SsZSWkbBmk/FzeMReM+KuGnhJgS4TrNrfAuAGy10PqqnauKCcvHrv79/8fKgVOA2KLrhCFZv7/7F95++p5ENC+MmjW5YdlUVWeFm0pfeAXXtyFu4AyH3F0fNtKizYFvQ2ZsCt2pypcCNa+ZwI+2P2fiMto6Sh0U198NVitwGG3vcvOO49Qa4tWN8C37cjfLSOe5G8tJH5Le/vyDJYhs3ljqqcGua+cEUBdG/+eq02h6uNyRpLDa//eKfSGYqbJ4OwKN8AdniJgS4dgeceIud2caRfUag1BRx6wQ4jjfcARfeADdHecEt1P1d1GrdwqZz75qo96wZ+DNNQn3fS4rRzcJeHuDoBobHt92MbiMqq8HUyl7GG9vAYN4AN0dNF7d2gNu0NrAE3OIoK9xs+yLwVndgIG+Am6MmjVubN/4ZbgOHU8DNUdPGrTugNh0Yxhvg5qiJ49YJcFwHBvEGuDkqK9wG2fMBjj/DMIQ3wM1R08eND3DrDm+2wAFujtoF3PgHM7R5sw1wgJujdgK3OsCt25ck6R+iNVoHxrHPXlnhNiRVYKIBjnTAYQIXpfDv+rAqeIHCvz5Tc2eGcsCNBjjageG8xSj8I0Urj19B4Z/O1NyZoZxww7yxDgzmLUbh3xYztjiFwj+dqbkzQ7nhhgbUqgNDeRsTt7kgulwo/CtJhIPCP52puTNDOc+060MiLd7i4KaSUPhXkjoFKPzTmZo7M5Qzbuv6kMgw3mIU/tFn7ULhn1IJ49YEOP54iPFwGqPwryTP0S2h8E9nau7MUGPgVh/zHcJbjMI/ShsU/imVaqpQdaDirQHOlLcYhX803J1C4Z/O1NyZoUbCTTKgGvIWPTxHUeqVWNbODDUWboN5A9wctZu4NRO4Gjgj3nYTtxGVFW6jpApMQoBbGhwPib4DuWtncZMNqFreou9A7nLCjT6tGevhdZinNY+5AfGIiJa36DuQu1xwe3h9zp5FX749L68Yedng1hwRqRfoeIu+A7nLBbe75+/Ig+jpO9HU3JmhxksVmGx5A9wc5YLbzbOP5d13b8i7P7LB9BMsX/dzKUbf4pzeu6a5Z83S8+1qxvztclPf92KAGx4+GW5fnxP4qPKJbmUV4PgDcHb2rv53S2NFt+odb2ruzFA+cOvy1jucAm6OGmnu9vsguI2dKlBZ8BZ9B3KXW2Z6xmWmAQZTP7ixIyL1CYYe3qLvQO4a4bgbDnDo3ed1cpobbt0Ap+Yt+g7krt09q9CSIW+ZFv7xWpyKy4RNCAtUBYMq5zIvWFnh5iVVoGIDKvuk4i37wj9D3IzXANz61NcBAlzNm729q/9aHgr/cJEeq+Nb/HNBLwQm/0jlHmtR1/eVnYJBbmW8nTr6ogUtL2VdO6j9AnYONwpcP29j4jYTRJf7KPzD15+za8EX5Lpvru5gdcBilLK+ryzFBdXKdckgKx9j1YILvsbQ5AvcQdzIFK5KUKW85Vv4V7KlZJirq6qYhwo3RX0fXaO9gFu5rEoGSzry4xWpl8qnwReQIm7+UoVK3IAq4y3fwr+6NuHPfBEfq9xrUJHX95XiAm5lVjL4Ka2iodWCjRfs0+ALkOFGUia9MsZNw1u+hX98dEM/I9fIqqr66/vE6Fav3JQMsl6SLhIvjtENb9lAOePGT+BE3vIt/GvmbvU9GlaPLlnlXjWYKur7ylJc0Kx8TSu3SEhGwZT34jp3WxkVFWaNG53A0XcCb/kW/pVczojL+dBW/wHPsUjlHtrKZV99Xyku4FamJYNNZoo3z7y4ZaZkZC60tYX5pgpUTcLQ5S3634tPWRVcDazOyipVCIRbM6ACbqOs3Ahwk0rB26RxCyFL3NA4faqdwE0ANwVvgJuj7HBb7P98copvQterzFMFKjSgirxF34HcZXsgBB8L2cZKFULihgOcwFv0HchdgJtalDf+6pDoO5C7bI+7/YyJ671X+nRwE3mLvgO5yzJV2JIzLJptTiFVoJrPCW+D7V39T05wIKRfbd4AN0fZnlUwOWk6JdwIb/VwCrg5yi663V8YnMOaFm4t3gA3Rw0YTOkJ3R5NJlWg4niLvgO5yxq3baEdUCeGGzmFSnmLvgO5y3owNbgEydstaaJpPtq9akx+kzEK/+LW98nV973s6uWVcs1peppP4V/c+j6lLAfThVF0s3ZmqCipAhUaUJfJF/4lU99n/wWo5m7Ia7S5W0Tcyg3mbUzcloLocpfCv1Tq+4y+gJZ6DvMuJn41r1yYt/QL/9Ko77P/AqS44YCqP4s1TdzwgNp7r8Fx/LsX/iVQ32f/BSjOKujOl/Km5s4MFS9VoNq48ua/8C+N+j77LyDFc6axcXPmzX/hXxr1ffZfgPLi8YhXhETHbe3Im//CvzTq++y/APn1bqS/O3O9m8R+s5zrV/PmfwyFKLhSyvZqXvwS7WreyKkCsXfiDXBTNQBuCnsX3lLALaqyGkyTwA3zNhQ4wE3VkGKqkAZuiLdyIHCAm6oBDoSo7RFvw4AD3FQNgFuPPeatHMAb4KZqkOC20F833jI1d2aoZHAbyhvgpmoQcVvsv6e5gk47gBu9/M2aN8BN1SDgRo51G90udeqpAhXhzRI4wE3VIOBGDrrhM3da7QZutPrUjjfATdUAuGnt7XkD3FQNgJve3po3wE3VkCJuKaUKREt8SwcL3nT+Xdtd/fu2t8KtqLRbZc099ktyiyTzhAFwUzXAYV4Te8qbcYAD3FQNgJuRvR1vgJuqwfxpzVQPr8+7pubODJVaqoBV8WYEHOCmajB6Fv159Sz6svxwvJu4VbwZBTjATdVggNvd83fkQfRYN7/93Y7iNrPgDXBTNRjgdvPsY3n33Rv89uGHP9HB9BOsUW7eIlHha8NOmi3XG/JmPo/ck4xlgNvV0xq3D2ch5m4JpgpYy/qZbboAB9FN1WAV3dC7HcaN560fOMBN1WA1d/twjHXWMTV3ZqhUcZs1vPUHOMBN1WCUmZ41mekuRzfKm0GAA9xUDebH3WiA29XjblSYN4MAB7ipGlI8q5Aubh3eVMABbqoGwM3OvsWbKsABbqoGwM3S3oQ3wE3VkCJuyaYKRB3eZMABbqoGwM3anvLWF+AAN1UD4GZvT3jrG1ABN1UD4DbAXscb4KZqSBG3pFMFoi5vHeAAN1UD4DbIvsNbJ8ABbqoGwG2YPeNNPqACbqoGwG2gPeVNPqACbqqGFHFLPlUg6vLGAQe4qRoAt8H2Am81cICbqgFwG24v8samcICbqgFwc7CX8TY3sAfcUsIti1SBqOKtE+AAN1UD4OZkz3jrBDjATdUAuLnZy3jzXqmlU2x7wM2bfc0bB9xawxvglhJu2aQKRBVvXIBba+Ib4Aa4DbYXeVtrKlEBN8BtuH3D24az91gYqFNse8DNq33NGwtw1N5fYaBOse394ObrviVp3pKmT7Nl9W7DLYV71whKMbpllZlSteNbba+YwUF0A9zc7DneNry9l0otnWLbA27e7Rveyk3L3kOllk6x7fPCLbtUgWi27CQMlcQAB7gBbs72s7Libd3mTQhwgBvg5m5f87Yuu7yNWzqjU2x7wC2IfcXbunNNUjly6YxOse3zwi3LVIGI8UbsewIc4Aa4jWJPeaP2Hd5GLJ3RKbY94BbKnvDG7LsD6milMzrFtgfcgtlj3mr7Lm8jlc7oFNs+L9yyTRWIEG+NvcjbGKUzOsW2B9wC2jfH30rJgDpG6YxOse0Bt5D2szXHmyzAAW6A24j2rfgm8uZcOqNTbPu8cMs6VSD2iDd+QBXaHR9ypPUf2R5wC2w/K/smcGvHhxzp/ce1B9xC28/6BlS8fZeHHBn4j2oPuIW37+GNbn94LYOR/4j2eeGWfapA7Tu8bbrtwx9yZOY/nj3gFsO+nTBwwNXbH1jLYOg/mj3gFsW+nTB06lCpBtUymPqPZQ+4xbHvJAztOlSmAbUMxv4j2eeF2zRSBSqBt03Z3b59LYOF/yj2gFs0+y5vOMB1t2/7GBAb/zHs3XCjT2vGuvn6+HiXn9Y8xF7kbSNuf251cbmV/wj2Trjh54HTZ9HfffemvPnmTcfU3JmhpoVbN0EtZWdR7S4ut/Mf3t4Jt7vn79iD6K8wdG+r8AapgqF9N0Et1+JlSaXNxeWW/oPbO+F28+wjiWtU9N0nWLHvb5KNZrP1srNoI1tv+vewMcDt6imH28Prsy6p5mwbamrRrewOqLhdGuAMLy639x/WfrTodvdtTRvgZmPfGlBpu5w3k4vLB/gPaj/S3A1lpufNckgVbOz5I76sXRHg5kn2f5wNGGWmZywzbdEGuFnaNwNq3a4CTne57yD/4ezHOO6GAtyHYyzvmelEcWsGVK5dCty6/07SQ/0Hs4ezCknYz1iAa7VLeMPtLsDF3v+8cJtiqsBEA1y7XQxwtH04cLH3H3BLxR7ztuy2d3mr2ocCF3v/Abdk7BFv3ZOoQoBr7IcBF3v/Abd07NEEbi3wJqtloBoCXOz9zwu3yaYKTLO1GN9ktQxM9sDF3n/ALSl7MoETlkpqGZhsgYu9/4BbUvbrmXCRCJGkloHJ7shv7P0H3JKyX0suSqKS1DJUsgAu9v7nhdu0UwXWPhOvusSS1DLUMgYu9v4DbknZ03b5DK7zkKO2DIGLvf+AW1L2rH2mBE565p7ICLjY+w+4JWVftytShrXiUhEiA+Bi739euO1CqlBJOoXD7b3AaYiLvf+AW1L2rXbJiErbe4DDxCV8wy7ALSn7drs4hava+4DrG1Vj7z/glpR9t52ctl/K2ocBF3v/88Jtd1KFSrM2cHz7EOBi7z/glpS9pL0FXLtdB5xIXOz9B9ySspe2z5or4brt/cCJxMXef8AtKXtFe50ziO19R36x2sTF3v+8cNu5VKEWA07argGOPzYSe/8Bt6Tse9opcLKLRfTA1UEu9v77wc3XfUsKXxvOQrMZ+t+yewsbKjSm6sznSd/XBqJbBHtN+0x17h5LN4srE6jCz2sw3dVUgWvvA05P3FpzkksnwC3oBuLjpr46iWrTixzd/nDiALegG0gBNx1wfZlDvf2BxAFuQTeQBm79aSqWCjh++0OI2y3cdj1V4NrZua2eQdVg+9bEAW5Wmg5uLE3tIU42iRO3H7ZwEHBLyt6yfTbrXqHUlkCcdPsWySrgZqWJ4VZqDsWVXeKU2zdEbrdwg1RBtlCfN9TI9W5/rmcOcAu6gSRx0+cNNXL6/vutdQDckrJ3uGJESxxBTnueC0uNHOAWdAPJ4lZyxPUgt9acdWg0n8vG1t3CDVKF/mZKXA9y1N4UuVKYzwFuVpo4biUhrkZOZK6xNx5ZS/7YHOBmpenjhlUhJ87lOvZ2Uc7Yf48At5Tsx8ENazZr5nLdZ27xsohy8umcnbLCDVIFO3dclKPMKew3ptBheyfoALeU7EfGrWyiHB1Ze+03euoa+4GhDnBLyX583IhmDDp5/tBRH3SC/zknk54AbinZe8KNikI3W1pAp3pqjVQm1GWFG6QKI/jnoVvq2OtAZ+J/3hfxALeU7EPgRjVrJnVskNVCZzC3E9SFDnBLyT4cblQzXtpQR+0HQ4cFuKVkHxq3lmb6YbZzVmJjHfaccKNPa26/KyFVGG4fFTcmWcQzmuiZsOeC28Prc/Ys+uYdb2ruzFCAm2f/CukIlOAoiX5YLrjdPX+HH0TfesebCor9a0fvQKa4qe1nonpZdMHt5tnH8u67N613n2DFvr8JKDsZ4Hb1tIKseceTqv/jsBSkCp79+7Z3mrvJohtvau7MUICbZ/++7Z1wCz53A9w8+/dt75iZntWZ6VmIzBRw8+zft/0Yx91wWIPjbqPYA24pnVUA3Dz7920PuCVlD7gBbgHtAbeUcINUwbN/3/aAW1L2gBvgFtAecAPcAtoDbkNwA4FsNRw3NYeR7d03AP49dwBwG1G77h9wC6pd9x8WNxBII8ANFFCAGyigADdQQAFuoIAaC7ebr48/f9epf7bQh2Os88H2+Irj48/eDO/ACMLVuPH8ox/gOKZ/M9cj4YYLZz48/diuf7bUlZP923PHDTjrA/q5o/nHP8DNN28i7r+R65FwI7Vaz9+1a2jshL+w4fbYsuwW8QTVzW9/dx7P/xX+od+eR9x/I9fjRrd2haCd8F/GcPubZ3/Eg6lLB9z08MOf0J93PP8l+REi+jdyPdbcjQ7c7fpnuw1gs+H2N1+T39qhA476cIZHk3j+ab1cRP9GrkfA7e3x8a/QtKG8+vzdoD8ubE97OzA4kA5Qyyh/3cz/Q6zoRr/Au2/PXIYHZ4WMbgxth6nDW/Rluczdfu/aATfR1Pos3twJh/eoc9eQczcW3dr1zzZ6+AH/XQy3x5kpiTCDN+AsHN2i+ae0xfNv6HqsudvVsdthLxaGhx82QpYuB/5GUNTjbu4HLp0V8LgbCGQiwA0UUIAbKKAAN1BAAW6ggALcQAEFuIECCnADBdSUcbu/KKgOTC2uH7/qbV8Ve/UK20eXeHW8iF9s071TYdn//rdZx26/GOAwAU0ZNywdQFZr355wgCDc2KLWYnOtxL8CpX+hYbv/fojP2ALcLNZuNVPc8CI7H5VkAcocN1lozEC7gdv1kz8Uj37Eb/FnPMgSVtC7I/T/FRoWD9GYe4Rbr8W16LB8UOKVaES6PSn2XuLB9Hu06BdkMVudeLqsPpD208q+bG1zheMT88s5OOp0/2VRoBWr13pLmYa3HcHt8IC9Rf+7vzhgPzZ9QcyR4XBFJmOytfB7/K+KMbcnR+hfvTqFk65OPDUfkP0K03dARtz2No/Y6MytIASx60PaiLdU9YJsZWBIja1dwe20wY2Mgmy+xWj5v/f0PYcbvxZ5z1KD+vOqhVu1OvHU+lBts2yW4/fkhfPL9ZbvfrUF9lr1pBw6YYysHcGtGiHx/1Y0XSWjFo4xJNxs0ZI9Hjd+LTJwcVTQcfAJj1u1Olml9aGCpGyW4/cVycRvtYKIG16AwX1CCat6Us0DctMu4sbPerb7f73AI+Peq05049cywY2tTnHjP/C4cdskuFV+u7itKigBt7wkwW3LHyS7/eJ79EuSX3Hbim78WuR9dzDdtgfTPW44bH3gB1NumwQ3zi/XW777ZBB9ctnqFQymyYrDDU/w7y/2UBKAfuT6l1/gRA9/uj4kP7tsLTFVOBBTBbo6izzcB5Z20H+c58VR47daQWAIUoW8xOFGjjP85gt6iKOOM1t8oAJBV+z9OxqzMDyStdjhh/onrg+E1LhVq9NV+A/VQZWDZjl1jCMb81uvsOicASEHQA6a1+ZAyAoOhIAsZHQeShnD4DAvyE6Sk1iClLjleZQXcIsnkwClwg1O0YNAWgFuoIAC3EABBbiBAgpwAwUU4AYKKMANFFD/D9RvUs76YGaoAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
</div>
</div>
<div id="final-analysis-with-trial-data" class="section level1">
<h1>Final Analysis with Trial Data</h1>
<p>When the actual trial data are available, the final analysis can be run with RBesT via the <strong><code>postmix</code></strong> function. The real data are used for this example, where the trial data led to a negative conclusion. However, note that <strong><code>postmix</code></strong> assumes that the sampling standard deviation is known and fixed. Therefore, no uncertainty in its estimate is taken into account.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## one can either use summary data or individual data. See ?postmix.
y.act &lt;-<span class="st"> </span><span class="op">-</span><span class="fl">29.15</span>
y.act.se &lt;-<span class="st"> </span><span class="fl">16.69</span>
n.act &lt;-<span class="st"> </span><span class="dv">39</span>

y.pbo &lt;-<span class="st"> </span><span class="op">-</span><span class="fl">76.01</span>
y.pbo.se &lt;-<span class="st"> </span><span class="fl">21.93</span>
n.pbo &lt;-<span class="st"> </span><span class="dv">20</span>

## first obtain posterior distributions
post_act &lt;-<span class="st"> </span><span class="kw">postmix</span>(weak_prior, <span class="dt">m=</span>y.act, <span class="dt">se=</span>y.act.se)
post_pbo &lt;-<span class="st"> </span><span class="kw">postmix</span>(map_robust, <span class="dt">m=</span>y.pbo, <span class="dt">se=</span>y.pbo.se)

## then calculate probability for the dual criteria
## and compare to the predefined threshold values
p1 &lt;-<span class="st"> </span><span class="kw">pmixdiff</span>(post_act, post_pbo, <span class="dv">0</span>); <span class="kw">print</span>(p1)</code></pre></div>
<pre><code>## [1] 0.08548337</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p2 &lt;-<span class="st"> </span><span class="kw">pmixdiff</span>(post_act, post_pbo, <span class="op">-</span><span class="dv">50</span>); <span class="kw">print</span>(p2)</code></pre></div>
<pre><code>## [1] 9.052263e-05</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(p1<span class="op">&gt;</span><span class="fl">0.95</span> <span class="op">&amp;</span><span class="st"> </span>p2<span class="op">&gt;</span><span class="fl">0.5</span>)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## or we can use the decision function
<span class="kw">poc</span>(post_act, post_pbo)</code></pre></div>
<pre><code>## [1] 0</code></pre>
<div id="references" class="section level3">
<h3>References</h3>
<p>[1] Neuenschwander B et. al, <em>Clin Trials</em>. 2010; 7(1):5-18<br />
[2] Hueber W. et. al, <em>Gut</em>, 2012, 61(12):1693-1700<br />
[3] Kass RE, Wasserman L, <em>J Amer Statist Assoc</em>; 1995, 90(431):928-934.<br />
[4] Morita S. et. al, <em>Biometrics</em> 2008;64(2):595-602<br />
[5] Schmidli H. et. al, <em>Biometrics</em> 2014;70(4):1023-1032</p>
</div>
<div id="r-session-info" class="section level3">
<h3>R Session Info</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.3.3 (2017-03-06)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 14393)
## 
## locale:
## [1] LC_COLLATE=C                        LC_CTYPE=German_Switzerland.1252   
## [3] LC_MONETARY=German_Switzerland.1252 LC_NUMERIC=C                       
## [5] LC_TIME=German_Switzerland.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] bayesplot_1.4.0 RBesT_1.3-1     Rcpp_0.12.14    knitr_1.17     
##  [5] dplyr_0.7.4     purrr_0.2.3     readr_1.1.1     tidyr_0.7.0    
##  [9] tibble_1.3.3    ggplot2_2.2.1   tidyverse_1.1.1
## 
## loaded via a namespace (and not attached):
##  [1] rstan_2.17.2       tidyselect_0.1.1   reshape2_1.4.2    
##  [4] haven_1.1.0        lattice_0.20-34    colorspace_1.3-2  
##  [7] htmltools_0.3.6    stats4_3.3.3       yaml_2.1.14       
## [10] rlang_0.1.2        foreign_0.8-67     glue_1.1.1        
## [13] modelr_0.1.1       readxl_1.0.0       bindrcpp_0.2      
## [16] bindr_0.1          plyr_1.8.4         stringr_1.2.0     
## [19] munsell_0.4.3      gtable_0.2.0       cellranger_1.1.0  
## [22] rvest_0.3.2        mvtnorm_1.0-6      codetools_0.2-15  
## [25] psych_1.7.5        evaluate_0.10.1    labeling_0.3      
## [28] inline_0.3.14      forcats_0.2.0      parallel_3.3.3    
## [31] highr_0.6          broom_0.4.2        scales_0.4.1      
## [34] backports_1.1.0    checkmate_1.8.5    StanHeaders_2.17.1
## [37] jsonlite_1.5       gridExtra_2.2.1    mnormt_1.5-5      
## [40] hms_0.3            digest_0.6.12      stringi_1.1.5     
## [43] grid_3.3.3         rprojroot_1.2      tools_3.3.3       
## [46] magrittr_1.5       lazyeval_0.2.0     Formula_1.2-2     
## [49] pkgconfig_2.0.1    xml2_1.1.1         lubridate_1.6.0   
## [52] assertthat_0.2.0   rmarkdown_1.6      httr_1.3.1        
## [55] R6_2.2.2           nlme_3.1-131</code></pre>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
