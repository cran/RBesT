<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Sebastian Weber" />

<meta name="date" content="2025-04-25" />

<title>Getting started with RBesT (binary)</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Getting started with RBesT (binary)</h1>
<h4 class="author">Sebastian Weber</h4>
<h4 class="date">2025-04-25</h4>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#binary-responder-analysis-example" id="toc-binary-responder-analysis-example">Binary responder analysis
example</a></li>
<li><a href="#prior-derivation" id="toc-prior-derivation">Prior
Derivation</a>
<ul>
<li><a href="#meta-analytic-predictive-analysis" id="toc-meta-analytic-predictive-analysis">Meta-Analytic-Predictive
Analysis</a></li>
<li><a href="#parametric-approximation" id="toc-parametric-approximation">Parametric Approximation</a></li>
<li><a href="#effective-sample-size" id="toc-effective-sample-size">Effective Sample Size</a></li>
<li><a href="#robustification-of-the-map-prior" id="toc-robustification-of-the-map-prior">Robustification of the MAP
Prior</a></li>
</ul></li>
<li><a href="#design-evaluation" id="toc-design-evaluation">Design
Evaluation</a>
<ul>
<li><a href="#operating-characteristics" id="toc-operating-characteristics">Operating Characteristics</a>
<ul>
<li><a href="#type-i-error" id="toc-type-i-error">Type I Error</a></li>
<li><a href="#power" id="toc-power">Power</a></li>
<li><a href="#data-scenarios" id="toc-data-scenarios">Data
Scenarios</a></li>
</ul></li>
</ul></li>
<li><a href="#trial-analysis" id="toc-trial-analysis">Trial Analysis</a>
<ul>
<li><a href="#references" id="toc-references">References</a></li>
<li><a href="#r-session-info" id="toc-r-session-info">R Session
Info</a></li>
</ul></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The R Bayesian evidence synthesis Tools (RBesT) facilitate the use of
historical information in clinical trials. Once relevant historical
information has been identified, RBesT supports the derivation of
informative priors via the Meta-Analytic-Predictive (MAP) approach [1]
and the evaluation of the trial’s operating characteristics. The MAP
approach performs a standard meta-analysis followed by a prediction for
the control group parameter of a future study while accounting for the
uncertainty in the population mean (the standard result from a
meta-analysis) and the between-trial heterogeneity. Therefore, RBesT can
also be used as a meta-analysis tool if one simply neglects the
prediction part.</p>
<p>This document demonstrates RBesT as it can be used to derive from
historical control data a prior for a binary endpoint. The <a href="https://opensource.nibr.com/RBesT/">RBesT package homepage</a>
contains further articles on introductory material:</p>
<ul>
<li>Probability of success with co-data</li>
<li>Probability of success at an interim with a normal endpoint</li>
<li>Customizing RBesT plots</li>
<li>RBesT for a normal endpoint</li>
<li>Meta-Analytic-Predictive priors for variances</li>
</ul>
</div>
<div id="binary-responder-analysis-example" class="section level1">
<h1>Binary responder analysis example</h1>
<p>Let’s consider a Novartis Phase II study in ankylosing spondylitis
comparing the Novartis test treatment secukinumab with placebo [2]. The
primary efficacy endpoint was percentage of patients with a 20% response
according to the Assessment of SpondyloArthritis international Society
criteria for improvement (ASAS20) at week 6. For the control group, the
following historical data were used to derive the MAP prior:</p>
<table>
<thead>
<tr class="header">
<th align="left">study</th>
<th align="right">n</th>
<th align="right">r</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Study 1</td>
<td align="right">107</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="left">Study 2</td>
<td align="right">44</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">Study 3</td>
<td align="right">51</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="left">Study 4</td>
<td align="right">39</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">Study 5</td>
<td align="right">139</td>
<td align="right">39</td>
</tr>
<tr class="even">
<td align="left">Study 6</td>
<td align="right">20</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Study 7</td>
<td align="right">78</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">Study 8</td>
<td align="right">35</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<p>This dataset is part of RBesT and available after loading the package
in the data frame <code>AS</code>.</p>
<p>RBesT supports all required steps to design a clinical trial with
historical information using the MAP approach.</p>
</div>
<div id="prior-derivation" class="section level1">
<h1>Prior Derivation</h1>
<div id="meta-analytic-predictive-analysis" class="section level2">
<h2>Meta-Analytic-Predictive Analysis</h2>
<p>The <strong><code>gMAP</code></strong> function performs the
meta-analysis and the prediction, which yields the MAP prior. The
analysis is run using stochastic Markov-Chain-Monte-Carlo with Stan. In
order to make results exactly reproducible, the <code>set.seed</code>
function must be called prior to calling
<strong><code>gMAP</code></strong> .</p>
<p>A key parameter in a meta-analysis is the between-trial heterogeneity
parameter <span class="math inline">\(\tau\)</span> which controls the
amount of borrowing from historical information for the estimation of
the population mean will occur. As we often have only few historical
trials, the prior is important. For binary endpoints with an expected
response rate of 20%-80% we recommend a conservative
<code>HalfNormal(0,1)</code> prior as a default. Please refer to the
help-page of <strong><code>gMAP</code></strong> for more
information.</p>
<p>The <strong><code>gMAP</code></strong> function returns an analysis
object from which we can extract information using the functions from
RBesT. We do recommend to look at the graphical model checks provided by
RBesT as demonstrated below. The most important one is the forest plot,
with solid lines for the MAP model predictions and dashed lines for the
stratified estimates. For a standard forest plot without the shrinkage
estimates please refer to the <code>forest_plot</code> function in
RBesT.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># load R packages</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(RBesT)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>()) <span class="co"># sets up plotting theme</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">34563</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>map_mcmc <span class="ot">&lt;-</span> <span class="fu">gMAP</span>(<span class="fu">cbind</span>(r, n <span class="sc">-</span> r) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> study,</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="at">data =</span> AS,</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="at">tau.dist =</span> <span class="st">&quot;HalfNormal&quot;</span>,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="at">tau.prior =</span> <span class="dv">1</span>,</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="at">beta.prior =</span> <span class="dv">2</span>,</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="at">family =</span> binomial</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Assuming default prior location   for beta: 0</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">print</span>(map_mcmc)</span></code></pre></div>
<pre><code>## Generalized Meta Analytic Predictive Prior Analysis
## 
## Call:  gMAP(formula = cbind(r, n - r) ~ 1 | study, family = binomial, 
##     data = AS, tau.dist = &quot;HalfNormal&quot;, tau.prior = 1, beta.prior = 2)
## 
## Exchangeability tau strata: 1 
## Prediction tau stratum    : 1 
## Maximal Rhat              : 1 
## 
## Between-trial heterogeneity of tau prediction stratum
##   mean     sd   2.5%    50%  97.5% 
## 0.3770 0.2170 0.0414 0.3460 0.8930 
## 
## MAP Prior MCMC sample
##   mean     sd   2.5%    50%  97.5% 
## 0.2580 0.0842 0.1120 0.2510 0.4590</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="do">## a graphical representation of model checks is available</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>pl <span class="ot">&lt;-</span> <span class="fu">plot</span>(map_mcmc)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="do">## a number of plots are immediately defined</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="fu">names</span>(pl)</span></code></pre></div>
<pre><code>## [1] &quot;densityThetaStar&quot;     &quot;densityThetaStarLink&quot; &quot;forest_model&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="do">## forest plot with model estimates</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">print</span>(pl<span class="sc">$</span>forest_model)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="100%" style="display: block; margin: auto;" /></p>
<p>An often raised concern with a Bayesian analysis is the choice of the
prior. Hence sensitivity analyses may sometimes be necessary. They can
be quickly performed with the <strong><code>update</code></strong>
function. Suppose we want to evaluate a more optimistic scenario (with
less between-trial heterogeneity), expressed by a
<code>HalfNormal(0,1/2)</code> prior on <span class="math inline">\(\tau\)</span>. Then we can rerun the original
analysis, but with modified arguments of
<strong><code>gMAP</code></strong>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">36546</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>map_mcmc_sens <span class="ot">&lt;-</span> <span class="fu">update</span>(map_mcmc, <span class="at">tau.prior =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Assuming default prior location   for beta: 0</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">print</span>(map_mcmc_sens)</span></code></pre></div>
<pre><code>## Generalized Meta Analytic Predictive Prior Analysis
## 
## Call:  gMAP(formula = cbind(r, n - r) ~ 1 | study, family = binomial, 
##     data = AS, tau.dist = &quot;HalfNormal&quot;, tau.prior = 1/2, beta.prior = 2)
## 
## Exchangeability tau strata: 1 
## Prediction tau stratum    : 1 
## Maximal Rhat              : 1 
## 
## Between-trial heterogeneity of tau prediction stratum
##   mean     sd   2.5%    50%  97.5% 
## 0.3340 0.1760 0.0382 0.3120 0.7240 
## 
## MAP Prior MCMC sample
##   mean     sd   2.5%    50%  97.5% 
## 0.2570 0.0794 0.1190 0.2480 0.4400</code></pre>
</div>
<div id="parametric-approximation" class="section level2">
<h2>Parametric Approximation</h2>
<p>As a next step, the MAP prior, represented numerically using a large
MCMC simulation sample, is converted to a parametric representation with
the <strong><code>automixfit</code></strong> function. This function
fits a parametric mixture representation using expectation-maximization
(EM). The number of mixture components to best describe the MAP is
chosen automatically. Again, the <code>plot</code> function produces a
graphical diagnostic which allows the user to assess whether the
marginal mixture density (shown in black) matches well with the
histogram of the MAP MCMC sample.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>map <span class="ot">&lt;-</span> <span class="fu">automixfit</span>(map_mcmc)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">print</span>(map)</span></code></pre></div>
<pre><code>## EM for Beta Mixture Model
## Log-Likelihood = 4523.865
## 
## Univariate beta mixture
## Mixture Components:
##   comp1      comp2     
## w  0.6167463  0.3832537
## a 19.1916387  3.5278745
## b 57.7779318  9.3735980</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">plot</span>(map)<span class="sc">$</span>mix</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="effective-sample-size" class="section level2">
<h2>Effective Sample Size</h2>
<p>The (usual) intended use of a (MAP) prior is to reduce the number of
control patients in the trial. The prior can be considered equivalent to
a number of experimental observations, which is called the effective
sample size (ESS) of the prior. It can be calculated in RBesT with the
<strong><code>ess</code></strong> function. It should be noted, however,
that the concept of ESS is somewhat elusive. In particular, the
definition of the ESS is not unique and multiple methods have therefore
been implemented in RBesT. The default method in RBesT is the elir
approach [5] which results in reasonable ESS estimates. The moment
matching approach leads to conservative (small) ESS estimates while the
Morita [3] method tends to estimates liberal (large) ESS estimates when
used with mixtures:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">ess</span>(map, <span class="at">method =</span> <span class="st">&quot;elir&quot;</span>)) <span class="do">## default method</span></span></code></pre></div>
<pre><code>## [1] 37</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">ess</span>(map, <span class="at">method =</span> <span class="st">&quot;moment&quot;</span>))</span></code></pre></div>
<pre><code>## [1] 26</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">ess</span>(map, <span class="at">method =</span> <span class="st">&quot;morita&quot;</span>))</span></code></pre></div>
<pre><code>## [1] 63</code></pre>
<p>The Morita approach uses the curvature of the prior at the mode and
has been found to be sensitive to a large number of mixture components.
From experience, a realistic ESS estimate can be obtained with the elir
method which is the only method which is predictively consistent, see
[5] for details.</p>
</div>
<div id="robustification-of-the-map-prior" class="section level2">
<h2>Robustification of the MAP Prior</h2>
<p>Finally, we recommend to <strong><code>robustify</code></strong> [4]
the prior which protects against type-I error inflation in presence of
prior-data conflict, i.e. if the future trial data strongly deviate from
the historical control information.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="do">## add a 20% non-informative mixture component</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>map_robust <span class="ot">&lt;-</span> <span class="fu">robustify</span>(map, <span class="at">weight =</span> <span class="fl">0.2</span>, <span class="at">mean =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">print</span>(map_robust)</span></code></pre></div>
<pre><code>## Univariate beta mixture
## Mixture Components:
##   comp1     comp2     robust   
## w  0.493397  0.306603  0.200000
## a 19.191639  3.527875  1.000000
## b 57.777932  9.373598  1.000000</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">ess</span>(map_robust))</span></code></pre></div>
<pre><code>## [1] 26</code></pre>
<p>Adding a robust mixture component does reduce the ESS of the MAP
prior to an extent which depends on the weight of the robust component.
Selecting higher robust mixture weights leads to greater discounting of
the informative MAP prior and vice versa. As a consequence the robust
weight controls the degree of influence of the MAP prior within the
final analysis. In some circumstances it can be helpful to graphically
illustrate the relationship of the prior ESS as a function of the robust
mixture component weight:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>ess_weight <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">weight =</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="at">by =</span> <span class="fl">0.05</span>), <span class="at">ess =</span> <span class="cn">NA</span>)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(ess_weight<span class="sc">$</span>weight)) {</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  ess_weight<span class="sc">$</span>ess[i] <span class="ot">&lt;-</span> <span class="fu">ess</span>(<span class="fu">robustify</span>(map, ess_weight<span class="sc">$</span>weight[i], <span class="fl">0.5</span>))</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>}</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>ess_weight <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  ess_weight,</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>    <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>    <span class="at">ess =</span> <span class="fu">c</span>(<span class="fu">ess</span>(map), <span class="fu">ess</span>(<span class="fu">mixbeta</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))))</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>  )</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>)</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="fu">ggplot</span>(ess_weight, <span class="fu">aes</span>(weight, ess)) <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ESS of robust MAP for varying weight of robust component&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">5</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="design-evaluation" class="section level1">
<h1>Design Evaluation</h1>
<p>Now we have a prior which can be specified in the protocol. The
advantage of using historical information is the possible reduction of
the placebo patient group. The sample size of the control group is
supplemented by the historical information. The reduction in placebo
patients can be about as large as the ESS of the MAP prior.</p>
<p>In the following, we compare designs with different sample sizes and
priors for the control group. The comparisons are carried out by
evaluating standard Frequentist operating characteristics (type-I error,
power). The scenarios are not exhaustive, but rather specific ones to
demonstrate the use of RBesT for design evaluation.</p>
<div id="operating-characteristics" class="section level2">
<h2>Operating Characteristics</h2>
<p>We consider the 2-arm design of the actual Novartis trial in
ankylosing spondylitis [2]. This trial tested 6 patients on placebo as
control against 24 patients on an active experimental treatment. Success
was declared whenever the condition</p>
<p><span class="math display">\[\Pr(\theta_{active} - \theta_{control}
&gt; 0) &gt; 0.95\]</span></p>
<p>was met for the response rates <span class="math inline">\(\theta_{active}\)</span> and <span class="math inline">\(\theta_{control}\)</span>. A MAP prior was used
for the placebo response rate parameter. Here we evaluate a few design
options as an example.</p>
<p>The operating characteristics are setup in RBesT in a stepwise
manner:</p>
<ol style="list-style-type: decimal">
<li>Definition of priors for each arm.</li>
<li>Definition of the decision criterion using the
<strong><code>decision2S</code></strong> function.</li>
<li>Specification of design options with the
<strong><code>oc2S</code></strong> function. This includes the overall
decision function and per arm the prior and the sample size to use.</li>
<li>The object from step 3 is then used to calculate the operating
characteristics.</li>
</ol>
<p>Note that for a 1-sample situation the respective
<code>decision1S</code> and <code>oc1S</code> function are used
instead.</p>
<div id="type-i-error" class="section level3">
<h3>Type I Error</h3>
<p>The type I can be increased compared to the nominal <span class="math inline">\(\alpha\)</span> level in case of a conflict
between the trial data and the prior. Note, that in this example the MAP
prior has a 95% interval of about 0.1 to 0.5.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.95</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>uniform_prior <span class="ot">&lt;-</span> <span class="fu">mixbeta</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>treat_prior <span class="ot">&lt;-</span> <span class="fu">mixbeta</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)) <span class="co"># prior for treatment used in trial</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>lancet_prior <span class="ot">&lt;-</span> <span class="fu">mixbeta</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">11</span>, <span class="dv">32</span>)) <span class="co"># prior for control   used in trial</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>decision <span class="ot">&lt;-</span> <span class="fu">decision2S</span>(<span class="fl">0.95</span>, <span class="dv">0</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>design_uniform <span class="ot">&lt;-</span> <span class="fu">oc2S</span>(uniform_prior, uniform_prior, <span class="dv">24</span>, <span class="dv">6</span>, decision)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>design_classic <span class="ot">&lt;-</span> <span class="fu">oc2S</span>(uniform_prior, uniform_prior, <span class="dv">24</span>, <span class="dv">24</span>, decision)</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>design_nonrobust <span class="ot">&lt;-</span> <span class="fu">oc2S</span>(treat_prior, map, <span class="dv">24</span>, <span class="dv">6</span>, decision)</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>design_robust <span class="ot">&lt;-</span> <span class="fu">oc2S</span>(treat_prior, map_robust, <span class="dv">24</span>, <span class="dv">6</span>, decision)</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>typeI_uniform <span class="ot">&lt;-</span> <span class="fu">design_uniform</span>(theta, theta)</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>typeI_classic <span class="ot">&lt;-</span> <span class="fu">design_classic</span>(theta, theta)</span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>typeI_nonrobust <span class="ot">&lt;-</span> <span class="fu">design_nonrobust</span>(theta, theta)</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>typeI_robust <span class="ot">&lt;-</span> <span class="fu">design_robust</span>(theta, theta)</span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a>ocI <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">theta =</span> theta, <span class="at">typeI =</span> typeI_robust, <span class="at">prior =</span> <span class="st">&quot;robust&quot;</span>),</span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">theta =</span> theta, <span class="at">typeI =</span> typeI_nonrobust, <span class="at">prior =</span> <span class="st">&quot;non-robust&quot;</span>),</span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">theta =</span> theta, <span class="at">typeI =</span> typeI_uniform, <span class="at">prior =</span> <span class="st">&quot;uniform&quot;</span>),</span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">theta =</span> theta, <span class="at">typeI =</span> typeI_classic, <span class="at">prior =</span> <span class="st">&quot;uniform 24:24&quot;</span>)</span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a>)</span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a></span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a><span class="fu">ggplot</span>(ocI, <span class="fu">aes</span>(theta, typeI, <span class="at">colour =</span> prior)) <span class="sc">+</span></span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Type I Error&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="100%" style="display: block; margin: auto;" /></p>
<p>Note that observing response rates greater that 50% is highly
implausible based on the MAP analysis:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">summary</span>(map)</span></code></pre></div>
<pre><code>##       mean         sd       2.5%      50.0%      97.5% 
## 0.25857963 0.08423297 0.10808237 0.25003652 0.47028444</code></pre>
<p>Hence, it is resonable to restrict the response rates <span class="math inline">\(\theta\)</span> for which we evaluate the type I
error to a a range of plausible values:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">ggplot</span>(ocI, <span class="fu">aes</span>(theta, typeI, <span class="at">colour =</span> prior)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Type I Error - response rate restricted to plausible range&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="power" class="section level3">
<h3>Power</h3>
<p>The power demonstrates the gain of using an informative prior;
i.e. 80% power is reached for smaller <span class="math inline">\(\delta\)</span> values in comparison to a design
with non-informative priors for both arms.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.7</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>mean_control <span class="ot">&lt;-</span> <span class="fu">summary</span>(map)[<span class="st">&quot;mean&quot;</span>]</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>theta_active <span class="ot">&lt;-</span> mean_control <span class="sc">+</span> delta</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>theta_control <span class="ot">&lt;-</span> mean_control <span class="sc">+</span> <span class="dv">0</span> <span class="sc">*</span> delta</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>power_uniform <span class="ot">&lt;-</span> <span class="fu">design_uniform</span>(theta_active, theta_control)</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>power_classic <span class="ot">&lt;-</span> <span class="fu">design_classic</span>(theta_active, theta_control)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>power_nonrobust <span class="ot">&lt;-</span> <span class="fu">design_nonrobust</span>(theta_active, theta_control)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>power_robust <span class="ot">&lt;-</span> <span class="fu">design_robust</span>(theta_active, theta_control)</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>ocP <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>  <span class="fu">data.frame</span>(theta_active, theta_control, <span class="at">delta =</span> delta, <span class="at">power =</span> power_robust, <span class="at">prior =</span> <span class="st">&quot;robust&quot;</span>),</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>  <span class="fu">data.frame</span>(theta_active, theta_control, <span class="at">delta =</span> delta, <span class="at">power =</span> power_nonrobust, <span class="at">prior =</span> <span class="st">&quot;non-robust&quot;</span>),</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>  <span class="fu">data.frame</span>(theta_active, theta_control, <span class="at">delta =</span> delta, <span class="at">power =</span> power_uniform, <span class="at">prior =</span> <span class="st">&quot;uniform&quot;</span>),</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>  <span class="fu">data.frame</span>(theta_active, theta_control, <span class="at">delta =</span> delta, <span class="at">power =</span> power_classic, <span class="at">prior =</span> <span class="st">&quot;uniform 24:24&quot;</span>)</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>)</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a><span class="fu">ggplot</span>(ocP, <span class="fu">aes</span>(delta, power, <span class="at">colour =</span> prior)) <span class="sc">+</span></span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Power&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="100%" style="display: block; margin: auto;" /></p>
<p>We see that with the MAP prior one reaches greater power at smaller
differences <span class="math inline">\(\delta\)</span> in the response
rate. For example, the <span class="math inline">\(\delta\)</span> for
which 80% power is reached can be found with:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>find_delta <span class="ot">&lt;-</span> <span class="cf">function</span>(design, theta_control, target_power) {</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  <span class="fu">uniroot</span>(</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>    <span class="cf">function</span>(delta) {</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>      <span class="fu">design</span>(theta_control <span class="sc">+</span> delta, theta_control) <span class="sc">-</span> target_power</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>    },</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>    <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span> <span class="sc">-</span> theta_control)</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  )<span class="sc">$</span>root</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>}</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>target_effect <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  <span class="at">delta =</span> <span class="fu">c</span>(</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>    <span class="fu">find_delta</span>(design_nonrobust, mean_control, <span class="fl">0.8</span>),</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>    <span class="fu">find_delta</span>(design_classic, mean_control, <span class="fl">0.8</span>),</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>    <span class="fu">find_delta</span>(design_robust, mean_control, <span class="fl">0.8</span>),</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>    <span class="fu">find_delta</span>(design_uniform, mean_control, <span class="fl">0.8</span>)</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>  ),</span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="st">&quot;non-robust&quot;</span>, <span class="st">&quot;uniform 24:24&quot;</span>, <span class="st">&quot;robust&quot;</span>, <span class="st">&quot;uniform&quot;</span>)</span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>)</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(target_effect, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">delta</th>
<th align="left">prior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.298</td>
<td align="left">non-robust</td>
</tr>
<tr class="even">
<td align="right">0.341</td>
<td align="left">uniform 24:24</td>
</tr>
<tr class="odd">
<td align="right">0.368</td>
<td align="left">robust</td>
</tr>
<tr class="even">
<td align="right">0.529</td>
<td align="left">uniform</td>
</tr>
</tbody>
</table>
</div>
<div id="data-scenarios" class="section level3">
<h3>Data Scenarios</h3>
<p>An alternative approach to visualize the study design to
non-statisticians is by considering data scenarios. These show the
decisions based on potential trial outcomes. The information needed are
the critical values at which the decision criterion flips. In the
2-sample case this means to calculate the decision boundary, see the
<strong><code>decision2S_boundary</code></strong> help for more
information.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="do">## Critical values at which the decision flips are given conditional</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="do">## on the outcome of the second read-out; as we like to have this as a</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="do">## function of the treatment group outcome, we flip label 1 and 2</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>decision_flipped <span class="ot">&lt;-</span> <span class="fu">decision2S</span>(<span class="fl">0.95</span>, <span class="dv">0</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>crit_uniform <span class="ot">&lt;-</span> <span class="fu">decision2S_boundary</span>(uniform_prior, uniform_prior, <span class="dv">6</span>, <span class="dv">24</span>, decision_flipped)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>crit_nonrobust <span class="ot">&lt;-</span> <span class="fu">decision2S_boundary</span>(map, treat_prior, <span class="dv">6</span>, <span class="dv">24</span>, decision_flipped)</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>crit_robust <span class="ot">&lt;-</span> <span class="fu">decision2S_boundary</span>(map_robust, treat_prior, <span class="dv">6</span>, <span class="dv">24</span>, decision_flipped)</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>treat_y2 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">24</span></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="do">## Note that -1 is returned to indicated that the decision is never 1</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>ocC <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">y2 =</span> treat_y2, <span class="at">y1_crit =</span> <span class="fu">crit_robust</span>(treat_y2), <span class="at">prior =</span> <span class="st">&quot;robust&quot;</span>),</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">y2 =</span> treat_y2, <span class="at">y1_crit =</span> <span class="fu">crit_nonrobust</span>(treat_y2), <span class="at">prior =</span> <span class="st">&quot;non-robust&quot;</span>),</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">y2 =</span> treat_y2, <span class="at">y1_crit =</span> <span class="fu">crit_uniform</span>(treat_y2), <span class="at">prior =</span> <span class="st">&quot;uniform&quot;</span>)</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>)</span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a><span class="fu">ggplot</span>(ocC, <span class="fu">aes</span>(y2, y1_crit, <span class="at">colour =</span> prior)) <span class="sc">+</span></span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a>  <span class="fu">geom_step</span>() <span class="sc">+</span></span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Critical values y1(y2)&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="100%" style="display: block; margin: auto;" /></p>
<p>The graph shows that the decision will always be negative if there
are less than 10 events in the treatment group. On the other hand, under
a non-robust prior and assuming 15 events in the treatment group, three
(or less) placebo events would be needed for success. To check this
result, we can directly evaluate the decision function:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="do">## just positive</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">decision</span>(<span class="fu">postmix</span>(treat_prior, <span class="at">n =</span> <span class="dv">24</span>, <span class="at">r =</span> <span class="dv">15</span>), <span class="fu">postmix</span>(map, <span class="at">n =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="do">## negative</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="fu">decision</span>(<span class="fu">postmix</span>(treat_prior, <span class="at">n =</span> <span class="dv">24</span>, <span class="at">r =</span> <span class="dv">14</span>), <span class="fu">postmix</span>(map, <span class="at">n =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
</div>
</div>
<div id="trial-analysis" class="section level1">
<h1>Trial Analysis</h1>
<p>Once the trial has completed and data is collected, the final
analysis can be run with RBesT using the
<strong><code>postmix</code></strong> function. Calculations are
performed analytically as we are in the conjugate mixture setting.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>r_placebo <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>r_treat <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a><span class="do">## first obtain posterior distributions...</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>post_placebo <span class="ot">&lt;-</span> <span class="fu">postmix</span>(map_robust, <span class="at">r =</span> r_placebo, <span class="at">n =</span> <span class="dv">6</span>)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>post_treat <span class="ot">&lt;-</span> <span class="fu">postmix</span>(treat_prior, <span class="at">r =</span> r_treat, <span class="at">n =</span> <span class="dv">24</span>)</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a><span class="do">## ...then calculate probability that the difference is smaller than</span></span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a><span class="do">## zero</span></span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>prob_smaller <span class="ot">&lt;-</span> <span class="fu">pmixdiff</span>(post_treat, post_placebo, <span class="dv">0</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>prob_smaller</span></code></pre></div>
<pre><code>## [1] 0.9913233</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>prob_smaller <span class="sc">&gt;</span> <span class="fl">0.95</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="do">## alternativley we can use the decision object</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="fu">decision</span>(post_treat, post_placebo)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div id="references" class="section level3">
<h3>References</h3>
<p>[1] Neuenschwander B. et al., <em>Clin Trials</em>. 2010;
7(1):5-18<br />
[2] Baeten D. et al., <em>The Lancet</em>, 2013, (382), 9906, p
1705<br />
[3] Morita S. et al., <em>Biometrics</em> 2008;64(2):595-602<br />
[4] Schmidli H. et al., <em>Biometrics</em> 2014;70(4):1023-1032<br />
[5] Neuenschwander B. et al., <em>Biometrics</em> 2020;76(2):578-587</p>
</div>
<div id="r-session-info" class="section level3">
<h3>R Session Info</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.4.2 (2024-10-31)
## Platform: aarch64-apple-darwin20
## Running under: macOS Sequoia 15.4
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
## LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## time zone: Europe/Zurich
## tzcode source: internal
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] ggplot2_3.5.1 knitr_1.47    RBesT_1.8-2  
## 
## loaded via a namespace (and not attached):
##  [1] gtable_0.3.5          tensorA_0.36.2.1      xfun_0.45            
##  [4] bslib_0.7.0           QuickJSR_1.2.2        inline_0.3.19        
##  [7] vctrs_0.6.5           tools_4.4.2           generics_0.1.3       
## [10] stats4_4.4.2          curl_5.2.1            parallel_4.4.2       
## [13] tibble_3.2.1          fansi_1.0.6           highr_0.11           
## [16] pkgconfig_2.0.3       checkmate_2.3.1       distributional_0.4.0 
## [19] RcppParallel_5.1.7    assertthat_0.2.1      lifecycle_1.0.4      
## [22] farver_2.1.2          compiler_4.4.2        stringr_1.5.1        
## [25] textshaping_0.4.0     munsell_0.5.1         codetools_0.2-20     
## [28] htmltools_0.5.8.1     sass_0.4.9            bayesplot_1.11.1     
## [31] yaml_2.3.8            Formula_1.2-5         pillar_1.9.0         
## [34] jquerylib_0.1.4       cachem_1.1.0          StanHeaders_2.32.10  
## [37] abind_1.4-5           posterior_1.6.0       rstan_2.32.7         
## [40] tidyselect_1.2.1      digest_0.6.35         mvtnorm_1.2-5        
## [43] stringi_1.8.4         dplyr_1.1.4           reshape2_1.4.4       
## [46] labeling_0.4.3        fastmap_1.2.0         grid_4.4.2           
## [49] colorspace_2.1-0      cli_3.6.2             magrittr_2.0.3       
## [52] loo_2.7.0             pkgbuild_1.4.4        utf8_1.2.4           
## [55] withr_3.0.0           scales_1.3.0          backports_1.5.0      
## [58] rmarkdown_2.29        matrixStats_1.3.0     gridExtra_2.3        
## [61] ragg_1.3.2            evaluate_0.24.0       V8_4.4.2             
## [64] rstantools_2.4.0.9000 rlang_1.1.4           Rcpp_1.0.12          
## [67] glue_1.7.0            jsonlite_1.8.8        R6_2.5.1             
## [70] plyr_1.8.9            systemfonts_1.1.0</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
