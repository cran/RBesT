<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Sebastian Weber" />

<meta name="date" content="2023-08-09" />

<title>Probability of Success with Co-Data</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Probability of Success with Co-Data</h1>
<h3 class="subtitle">Use of Co-Data in Clinical Trails with RBesT</h3>
<h4 class="author">Sebastian Weber</h4>
<h4 class="date">2023-08-09</h4>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#example-data-scenario" id="toc-example-data-scenario">Example Data Scenario</a></li>
<li><a href="#statistical-trial-design-considerations" id="toc-statistical-trial-design-considerations">Statistical Trial
Design Considerations</a>
<ul>
<li><a href="#power-calculation" id="toc-power-calculation">Power
calculation</a></li>
<li><a href="#critical-value" id="toc-critical-value">Critical
value</a></li>
</ul></li>
<li><a href="#pos-at-interim-for-phase-iii-trial-a-only" id="toc-pos-at-interim-for-phase-iii-trial-a-only">PoS at interim for
phase III trial A only</a>
<ul>
<li><a href="#no-use-of-historical-information" id="toc-no-use-of-historical-information">No use of historical
information</a></li>
<li><a href="#use-of-historical-information---map-approach" id="toc-use-of-historical-information---map-approach">Use of historical
information - MAP approach</a></li>
<li><a href="#use-of-historical-information---mac-approach" id="toc-use-of-historical-information---mac-approach">Use of historical
information - MAC approach</a></li>
</ul></li>
<li><a href="#differential-discounting" id="toc-differential-discounting">Differential discounting</a></li>
<li><a href="#pos-for-both-phase-iii-trials-being-successful" id="toc-pos-for-both-phase-iii-trials-being-successful">PoS for both
phase III trials being successful</a></li>
<li><a href="#summary" id="toc-summary">Summary</a></li>
<li><a href="#appendix-map-and-mac-equivalence" id="toc-appendix-map-and-mac-equivalence">Appendix: MAP and MAC
equivalence</a>
<ul>
<li><a href="#formal-map-and-mac-equivalence" id="toc-formal-map-and-mac-equivalence">Formal MAP and MAC
equivalence</a></li>
</ul></li>
<li><a href="#references" id="toc-references">References</a></li>
<li><a href="#r-session-info" id="toc-r-session-info">R Session
Info</a></li>
</ul>
</div>

<!-- To produce a html report, please execute in R -->
<!-- library(rmarkdown) -->
<!-- render("PoS_codata.Rmd") -->
<p>The probability of success is a very useful concept to assess the
chances of success of a trial while taking uncertainties into account.
In this document we briefly introduce the needed formal details,
describe an example data set and then demonstrate various ways of how
the probability of success concept can be applied to increasingly
complex data situations.</p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The co-data concept has been introduced in [1]. It differs from the
use of historical data in that the approach makes use of contemporary
data. A meta-analytic-predictive (MAP) analysis assumes that historical
data is known at the time-point of specyfing the analysis and is as such
a retrospective summary of available data. The MAP prior is then
combined with the current trial data. A co-data approach extends this
sequential procedure to a meta-analytic-combined (MAC) analysis. In the
MAC approach all available data is analyzed in a single step - that is,
historical and concurrent data is combined in a single inference step.
Both approaches MAP and MAC yield exactly the same results as is
demonstrated in the appendix at the bottom. An example for a co-data
scenario in drug development is the simultaneous execution of twin phase
III trails for registriation. In such a setting, a futility analysis at
an interim analysis may take historical and all contemporary data into
account in a co-data approach. This example has been discussed in [1]
using the probability of success (PoS) as metric to assess futility at
an interim analysis and is discussed here in detail.</p>
<p>The key property of the probability of success metric is the
consideration of uncertainty in parameters conditional on available
data. In contrast, the conditional power (CP) calculates the frequency a
given experemintal design will be successful for a known value of the
parameters. For example, in a 1-sample experiment with a one-sided
success criterion the trial is successful if the collected data <span class="math inline">\(y_N\)</span> of sample size <span class="math inline">\(N\)</span> exceeds some critical value <span class="math inline">\(y_c\)</span>; recall that the critical value <span class="math inline">\(y_c\)</span> is determined by the success
criterion, prior and sample size when evaluated. Assuming that the
sampling model of the data is <span class="math inline">\(p(y|\theta)\)</span>, then</p>
<p><span class="math display">\[ CP_N(\theta) = \int I(y_N  &gt; y_c) \,
p(y_N|\theta) \, dy_N.\]</span></p>
<p>The integration over the data <span class="math inline">\(y_N\)</span> comprises all possible outcomes of
the trial. Note that before the start of the trial, <span class="math inline">\(CP_N(\theta_0)\)</span> is the type I error rate
under the conventional null hypothesis (<span class="math inline">\(\theta=\theta_0\)</span>) and <span class="math inline">\(CP_N(\theta_a)\)</span> the power of the trial
under the alternative (<span class="math inline">\(\theta=\theta_a\)</span>). At an interim analysis
at sample size <span class="math inline">\(n_I\)</span>, the conditional
power is then evaluated conditional on the observed data so far (the
<span class="math inline">\(n_I\)</span> measurements) while the
remaining sample size (<span class="math inline">\(N-n_I\)</span>) is
random and distributed according to <span class="math inline">\(p(y|\theta)\)</span> with <span class="math inline">\(\theta\)</span> set to some known value,</p>
<p><span class="math display">\[ CP_{N-n_I}(\theta|y_{n_I}) = \int
I(y_{n_I} + y_{N-n_I} = y_N &gt; y_c|y_{n_I}) \, p(y_{N-n_I}|\theta) \,
dy_{N-n_I}.\]</span></p>
<p>The known value can be set equal to the observed point estimate at
the interim, <span class="math inline">\(CP_{N-n_I}(\hat{\theta}_{I}|y_{n_I})\)</span>, or
to the assumed true alternative, <span class="math inline">\(CP_{N-n_I}(\theta_a|y_{n_I})\)</span>, used to
plan the trial.</p>
<p>The probability of success in contrast assigns <span class="math inline">\(\theta\)</span> a distribution and marginalizes
the conditional power over this distribution. In absence of additional
trial external information this distribution is the posterior for <span class="math inline">\(p(\theta|y_{n_I})\)</span> obtained from the prior
for <span class="math inline">\(p(\theta)\)</span> and the data
collected up to the interim,</p>
<p><span class="math display">\[ PoS_I = \int CP_{N-n_I}(\theta|y_{n_I})
\, p(\theta|y_{n_I}) \, d\theta.\]</span></p>
<p>However, our knowledge about <span class="math inline">\(\theta\)</span> can be refined if other
data-sources like completed (historical) or concurrent trials are
available,</p>
<p><span class="math display">\[ PoS_{I,H,...} = \int
CP_{N-n_I}(\theta|y_{n_I}) \, p(\theta|y_{I},y_{H},...) \,
d\theta.\]</span></p>
<p>It is important to note that the conditional power is <em>always</em>
evaluated with respect to the trial data (and prior) only. Thus,
additional data-sources are not part of the analysis of the trial. In
practice this means that the probability of success is usually
calculated for a trial which uses non-informative priors, but at interim
we may use additional data-sources to refine our knowledge on <span class="math inline">\(\theta\)</span> which will not be part of the
trial analysis.</p>
</div>
<div id="example-data-scenario" class="section level1">
<h1>Example Data Scenario</h1>
<p>In the following the hypothetical example as in [1] is discussed. The
assumed endpoint is time-to-event, which is analyzed using the normal
approximation of the log-rank statistic for comparing two groups. Under
a 1:1 randomization the standard error of the log-hazard ratio scales
with the number of events as <span class="math inline">\(2/\sqrt{N_{events}}\)</span>. This implies a
corresponding sampling standard deviation of <span class="math inline">\(2\)</span>, which defines the unit information
prior used later on in the analysis. The historical data considered is a
proof of concept and a phase II trial. The twin phase III studies are
event driven. Each trial stops whenever a total of <span class="math inline">\(379\)</span> events is reached and an interim is
planned whenever at least <span class="math inline">\(150\)</span>
events have occured. The assumed true hazard ratio used for the design
of the trial is <span class="math inline">\(0.8\)</span>.</p>
<p>Example data:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">study  =</span> <span class="fu">c</span>(<span class="st">&quot;PoC&quot;</span>, <span class="st">&quot;PhII&quot;</span>, <span class="st">&quot;PhIII_A&quot;</span>, <span class="st">&quot;PhIII_B&quot;</span>),</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">deaths =</span> <span class="fu">c</span>(    <span class="dv">8</span>,     <span class="dv">85</span>,       <span class="dv">162</span>,       <span class="dv">150</span>),</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">HR     =</span> <span class="fu">c</span>(  <span class="fl">0.7</span>,   <span class="fl">0.75</span>,      <span class="fl">0.83</span>,      <span class="fl">0.78</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">## under the normal approximation of the log-HR, the sampling sd is 2</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">## such that the standard errors are sqrt(4/events)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> trials <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">logHR=</span><span class="fu">log</span>(HR), <span class="at">sem=</span><span class="fu">sqrt</span>(<span class="dv">4</span><span class="sc">/</span>deaths))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(trials, <span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">study</th>
<th align="right">deaths</th>
<th align="right">HR</th>
<th align="right">logHR</th>
<th align="right">sem</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PoC</td>
<td align="right">8</td>
<td align="right">0.70</td>
<td align="right">-0.36</td>
<td align="right">0.71</td>
</tr>
<tr class="even">
<td align="left">PhII</td>
<td align="right">85</td>
<td align="right">0.75</td>
<td align="right">-0.29</td>
<td align="right">0.22</td>
</tr>
<tr class="odd">
<td align="left">PhIII_A</td>
<td align="right">162</td>
<td align="right">0.83</td>
<td align="right">-0.19</td>
<td align="right">0.16</td>
</tr>
<tr class="even">
<td align="left">PhIII_B</td>
<td align="right">150</td>
<td align="right">0.78</td>
<td align="right">-0.25</td>
<td align="right">0.16</td>
</tr>
</tbody>
</table>
<p>The remaining outline of the vignette is to first evaluate the design
properties of the trials, then calculate the probability of success at
interim for the A trial only (using only trial A data). Next, the
probability of success is calculated using in addition the historical
data. Subsequently, the probability of success for trial A is calculated
also using the historical data <em>and</em> the concurrent phase III
data of trial B. Finally, the overall probability of success is
calculated, which is defined by the joint success of both trials. In the
appendix the equivalence of the MAP and MAC approach is
demonstrated.</p>
</div>
<div id="statistical-trial-design-considerations" class="section level1">
<h1>Statistical Trial Design Considerations</h1>
<p>Key design choices:</p>
<ul>
<li>time-to-event endpoint</li>
<li>phase III trials stop at target # of events 379</li>
<li>null hypothesis of no difference in HR, <span class="math inline">\(\theta_0 = 1.0\)</span></li>
<li>one-sided <span class="math inline">\(\alpha = 0.025\)</span></li>
<li>alternative hypothesis assumes true HR of <span class="math inline">\(\theta_a=0.75\)</span></li>
<li>interim when at least 150 events reached</li>
</ul>
<p>Historical data:</p>
<ul>
<li>promising internal PoC</li>
<li>promising phase II</li>
</ul>
<p>Co-data:</p>
<ul>
<li>two phase III trials run in parallel <span class="math inline">\(\Rightarrow\)</span> each phase III trial is
<em>concurrent</em> with the other</li>
</ul>
<p>Define design choices</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Nev <span class="ot">&lt;-</span> <span class="dv">379</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>alt_HR <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>alt_logHR <span class="ot">&lt;-</span> <span class="fu">log</span>(alt_HR)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.025</span></span></code></pre></div>
<div id="power-calculation" class="section level2">
<h2>Power calculation</h2>
<p>Here we use the unit information prior as non-informative prior and
define it using the mean &amp; effective sample size (ESS)
specification:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>unit_inf <span class="ot">&lt;-</span> <span class="fu">mixnorm</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">sigma=</span><span class="dv">2</span>, <span class="at">param=</span><span class="st">&quot;mn&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>unit_inf</span></code></pre></div>
<pre><code>## Univariate normal mixture
## Reference scale: 2
## Mixture Components:
##   comp1
## w 1    
## m 0    
## s 2</code></pre>
<p>Define conditional power for the overall trial:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>success_crit <span class="ot">&lt;-</span> <span class="fu">decision1S</span>(<span class="dv">1</span><span class="sc">-</span>alpha, <span class="dv">0</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="do">## let&#39;s print the defined criterion</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>success_crit</span></code></pre></div>
<pre><code>## 1 sample decision function
## Conditions for acceptance:
## P(theta &lt;= 0) &gt; 0.975</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">oc1S</span>(unit_inf, Nev, success_crit, <span class="at">sigma=</span><span class="dv">2</span>)</span></code></pre></div>
<p>Under the alternative these design choices result in 80% power</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">design</span>(alt_logHR)</span></code></pre></div>
<pre><code>## [1] 0.7986379</code></pre>
<p>The impact of the unit-information prior is minimal which can be seen
by comparing to the frequentist calculation:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">n=</span>Nev, <span class="at">delta=</span><span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>alt_logHR, <span class="at">sd=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;one.sample&quot;</span>, <span class="at">sig.level=</span><span class="fl">0.025</span>, <span class="at">alternative=</span><span class="st">&quot;one.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      One-sample t test power calculation 
## 
##               n = 379
##           delta = 0.2876821
##              sd = 2
##       sig.level = 0.025
##           power = 0.7976343
##     alternative = one.sided</code></pre>
<p>With RBesT we can explore the conditional power for a range of
alternatives:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">HR=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.2</span>)), <span class="fu">aes</span>(HR)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="fu">compose</span>(design, log)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">vline_at</span>(<span class="fu">c</span>(alt_HR, <span class="fl">1.0</span>), <span class="at">linetype=</span><span class="fu">I</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(alt_HR, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">1.2</span>,<span class="at">by=</span><span class="fl">0.2</span>))) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="fu">expression</span>(theta[a])) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">&quot;Power for N =&quot;</span>, Nev, <span class="st">&quot;events&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="critical-value" class="section level2">
<h2>Critical value</h2>
<p>The critical value determines at which observed logHR we
<em>just</em> conclude that the success criterion is fulfilled.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>design_crit <span class="ot">&lt;-</span> <span class="fu">decision1S_boundary</span>(unit_inf, Nev, success_crit, <span class="at">sigma=</span><span class="dv">2</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>design_crit</span></code></pre></div>
<pre><code>## [1] -0.2017185</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(design_crit)</span></code></pre></div>
<pre><code>## [1] 0.8173249</code></pre>
<p>We can check this:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">success_crit</span>(<span class="fu">postmix</span>(unit_inf, <span class="at">m=</span>design_crit, <span class="at">n=</span><span class="dv">379</span>))</span></code></pre></div>
<pre><code>## Using default prior reference scale 2</code></pre>
<pre><code>## [1] 1</code></pre>
<p>Ok, when observing the critical value, we get a success.</p>
<p>Now, what if we observe a 1% worse result?</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">success_crit</span>(<span class="fu">postmix</span>(unit_inf, <span class="at">m=</span>design_crit<span class="sc">+</span><span class="fu">log</span>(<span class="fl">1.01</span>), <span class="at">n=</span><span class="dv">379</span>))</span></code></pre></div>
<pre><code>## Using default prior reference scale 2</code></pre>
<pre><code>## [1] 0</code></pre>
<p>No success then <span class="math inline">\(\Rightarrow\)</span> this
is the critical boundary value.</p>
</div>
</div>
<div id="pos-at-interim-for-phase-iii-trial-a-only" class="section level1">
<h1>PoS at interim for phase III trial A only</h1>
<div id="no-use-of-historical-information" class="section level2">
<h2>No use of historical information</h2>
<p>Posterior of treatment effect at interim. The trial uses a
non-informative prior for the treatment effect:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>interim_A <span class="ot">&lt;-</span> <span class="fu">postmix</span>(unit_inf, <span class="at">m=</span>trials<span class="sc">$</span>logHR[<span class="dv">3</span>], <span class="at">se=</span>trials<span class="sc">$</span>sem[<span class="dv">3</span>])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>interim_A</span></code></pre></div>
<pre><code>## Univariate normal mixture
## Reference scale: 2
## Mixture Components:
##   comp1     
## w  1.0000000
## m -0.1851865
## s  0.1566521</code></pre>
<p>Now we are interested in the PoS at trial completion. The prior to
use for the analysis of the second half is given by the data collected
so far.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>interim_pos_A <span class="ot">&lt;-</span> <span class="fu">pos1S</span>(interim_A, Nev<span class="sc">-</span>trials<span class="sc">$</span>deaths[<span class="dv">3</span>], success_crit, <span class="at">sigma=</span><span class="dv">2</span>)</span></code></pre></div>
<p>The returned function can now calculate the PoS assuming any
distribution on the treatment effect. In case we do not use any
historical information, then this is just the interim posterior:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_A</span>(interim_A)</span></code></pre></div>
<pre><code>## [1] 0.4465623</code></pre>
<p>The above command integrates the <em>conditional power</em> over the
uncertainty which we have about the treatment effect as defined above
for <span class="math inline">\(PoS_I\)</span>.</p>
<p>The conditional power and the operating characteristics of a trial
coincide whenever we do not condition on any observed data. The key
difference of the conditional power as compared to the probability of
success is that it assumes a known value for the parameter of interest.
This can be seen as follows: First define the conditional power which is
conditional on the observed data, <span class="math inline">\(CP_{N-n_I}(\theta|y_{n_I})\)</span>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>interim_oc_A <span class="ot">&lt;-</span> <span class="fu">oc1S</span>(interim_A, Nev<span class="sc">-</span>trials<span class="sc">$</span>deaths[<span class="dv">3</span>], success_crit, <span class="at">sigma=</span><span class="dv">2</span>)</span></code></pre></div>
<p>The conditional power assuming the alternative is true (a HR of
0.75):</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_oc_A</span>(alt_logHR)</span></code></pre></div>
<pre><code>## [1] 0.708769</code></pre>
<p>In case there is no uncertainty of the treatment effect (here <span class="math inline">\(se=10^-4\)</span>), then this result agrees with
the probability of success calculation:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_A</span>(<span class="fu">mixnorm</span>(<span class="fu">c</span>(<span class="dv">1</span>, alt_logHR, <span class="fl">1E-4</span>)))</span></code></pre></div>
<pre><code>## [1] 0.7087689</code></pre>
<p>For trial B the calculation is:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>interim_B <span class="ot">&lt;-</span> <span class="fu">postmix</span>(unit_inf, <span class="at">m=</span>trials<span class="sc">$</span>logHR[<span class="dv">4</span>], <span class="at">se=</span>trials<span class="sc">$</span>sem[<span class="dv">4</span>])</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>interim_pos_B <span class="ot">&lt;-</span> <span class="fu">pos1S</span>(interim_B, Nev<span class="sc">-</span>trials<span class="sc">$</span>deaths[<span class="dv">4</span>], success_crit, <span class="at">sigma=</span><span class="dv">2</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_B</span>(interim_B)</span></code></pre></div>
<pre><code>## [1] 0.6411569</code></pre>
</div>
<div id="use-of-historical-information---map-approach" class="section level2">
<h2>Use of historical information - MAP approach</h2>
<p>However, we have historical information of which we can take
advantage at the interim for a better informed decision.</p>
<p>Our data before the phase III trials includes the PoC and the phase
II trial. We now derive from these a MAP prior; recall that the MAP
prior is the prediction of the log-hazard ratio of a future trial:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> trials[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,]</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">342345</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>base_map_mc <span class="ot">&lt;-</span> <span class="fu">gMAP</span>(<span class="fu">cbind</span>(logHR, sem) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> study,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family=</span>gaussian,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data=</span>base,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights=</span>deaths,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">tau.dist=</span><span class="st">&quot;HalfNormal&quot;</span>, <span class="at">tau.prior=</span><span class="fl">0.5</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">beta.prior=</span><span class="fu">cbind</span>(<span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">forest_plot</span>(base_map_mc, <span class="at">est=</span><span class="st">&quot;MAP&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>base_map <span class="ot">&lt;-</span> <span class="fu">automixfit</span>(base_map_mc)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(base_map)<span class="sc">$</span>mix <span class="sc">+</span> <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">log</span>(theta)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>base_map</span></code></pre></div>
<pre><code>## EM for Normal Mixture Model
## Log-Likelihood = -3052.469
## 
## Univariate normal mixture
## Reference scale: 2
## Mixture Components:
##   comp1       comp2       comp3      
## w  0.63321352  0.28687554  0.07991094
## m -0.29374195 -0.27177369 -0.27655187
## s  0.29655203  0.72086824  1.31037995</code></pre>
<p>At the interim we have even more knowledge available on the treatment
effect through the interim data itself which we can include into the MAP
prior:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>interim_A_combined <span class="ot">&lt;-</span> <span class="fu">postmix</span>(base_map, <span class="at">m=</span>trials<span class="sc">$</span>logHR[<span class="dv">3</span>], <span class="at">se=</span>trials<span class="sc">$</span>sem[<span class="dv">3</span>])</span></code></pre></div>
<p>The PoS for this posterior at interim (representing historical
<em>and</em> interim data collected) is:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_A</span>(interim_A_combined)</span></code></pre></div>
<pre><code>## [1] 0.4858313</code></pre>
<p>Note that we have not redefined <code>interim_pos_A</code>, such that
this calculates the PoS for the phase III A trial taking into account
that the final analysis will use a non-informative prior.</p>
<p>For trial B the calculation is:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>interim_B_combined <span class="ot">&lt;-</span> <span class="fu">postmix</span>(base_map, <span class="at">m=</span>trials<span class="sc">$</span>logHR[<span class="dv">4</span>], <span class="at">se=</span>trials<span class="sc">$</span>sem[<span class="dv">4</span>])</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_B</span>(interim_B_combined)</span></code></pre></div>
<pre><code>## [1] 0.669077</code></pre>
</div>
<div id="use-of-historical-information---mac-approach" class="section level2">
<h2>Use of historical information - MAC approach</h2>
<p>However, there is even more information which can be used here, since
the phase III result of trial B is also available:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>interim_map_mc <span class="ot">&lt;-</span> <span class="fu">update</span>(base_map_mc, <span class="at">data=</span>trials)</span></code></pre></div>
<p>Now the trial B specific posterior at interim is</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">fitted</span>(interim_map_mc), <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">2.5%</th>
<th align="right">50%</th>
<th align="right">97.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PoC</td>
<td align="right">-0.252</td>
<td align="right">0.226</td>
<td align="right">-0.747</td>
<td align="right">-0.244</td>
<td align="right">0.204</td>
</tr>
<tr class="even">
<td align="left">PhII</td>
<td align="right">-0.251</td>
<td align="right">0.152</td>
<td align="right">-0.572</td>
<td align="right">-0.246</td>
<td align="right">0.048</td>
</tr>
<tr class="odd">
<td align="left">PhIII_A</td>
<td align="right">-0.216</td>
<td align="right">0.126</td>
<td align="right">-0.456</td>
<td align="right">-0.219</td>
<td align="right">0.048</td>
</tr>
<tr class="even">
<td align="left">PhIII_B</td>
<td align="right">-0.240</td>
<td align="right">0.129</td>
<td align="right">-0.493</td>
<td align="right">-0.242</td>
<td align="right">0.013</td>
</tr>
</tbody>
</table>
<p>which we can extract as:</p>
<ol style="list-style-type: decimal">
<li>obtain posterior (which we restrict to the first 4 columns)</li>
</ol>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>interim_map_post <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(interim_map_mc)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(interim_map_post) <span class="co"># posterior is given as matrix: iteration x parameter</span></span></code></pre></div>
<pre><code>## [1] 4000    4</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(interim_map_post, <span class="at">n=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>##           parameters
## iterations   theta[1]   theta[2]   theta[3]    theta[4]
##       [1,] -0.3623909 -0.2900106 -0.3895825 -0.33736377
##       [2,] -0.2242581 -0.1874207 -0.3220053 -0.26273507
##       [3,] -0.2010742 -0.1312956 -0.2283408 -0.05753061</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>turn MCMC posterior sample into parametric mixture</li>
</ol>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>interim_A_allcombined <span class="ot">&lt;-</span> <span class="fu">automixfit</span>(interim_map_post[,<span class="st">&quot;theta[3]&quot;</span>])</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>and finally evaluate the PoS</li>
</ol>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_A</span>(interim_A_allcombined)</span></code></pre></div>
<pre><code>## [1] 0.5054541</code></pre>
<p>which aligns with the published result under the assumption of full
exchangeability.</p>
<p>For trial B computations are:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>interim_B_allcombined <span class="ot">&lt;-</span> <span class="fu">automixfit</span>(interim_map_post[,<span class="st">&quot;theta[4]&quot;</span>])</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_B</span>(interim_B_allcombined)</span></code></pre></div>
<pre><code>## [1] 0.6450459</code></pre>
</div>
</div>
<div id="differential-discounting" class="section level1">
<h1>Differential discounting</h1>
<p>Differential discounting allows to weight different data-sources
differently. For example, we may assume greater heterogeneity for the
historical data in comparison to the twin phase III trials.</p>
<p>Assign data to historical (2) and concurrent data strata (1):</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> trials <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stratum=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(trials, <span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">study</th>
<th align="right">deaths</th>
<th align="right">HR</th>
<th align="right">logHR</th>
<th align="right">sem</th>
<th align="right">stratum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PoC</td>
<td align="right">8</td>
<td align="right">0.70</td>
<td align="right">-0.36</td>
<td align="right">0.71</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">PhII</td>
<td align="right">85</td>
<td align="right">0.75</td>
<td align="right">-0.29</td>
<td align="right">0.22</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">PhIII_A</td>
<td align="right">162</td>
<td align="right">0.83</td>
<td align="right">-0.19</td>
<td align="right">0.16</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">PhIII_B</td>
<td align="right">150</td>
<td align="right">0.78</td>
<td align="right">-0.25</td>
<td align="right">0.16</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">435345</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>interim_diff_map_mc <span class="ot">&lt;-</span> <span class="fu">gMAP</span>(<span class="fu">cbind</span>(logHR, sem) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> study,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">tau.strata=</span>stratum,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">family=</span>gaussian,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data=</span>trials,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">weights=</span>deaths,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">tau.dist=</span><span class="st">&quot;HalfNormal&quot;</span>, <span class="at">tau.prior=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">beta.prior=</span><span class="fu">cbind</span>(<span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>interim_diff_map_post <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(interim_diff_map_mc)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>interim_A_diff_allcombined <span class="ot">&lt;-</span> <span class="fu">automixfit</span>(interim_diff_map_post[,<span class="st">&quot;theta[3]&quot;</span>])</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>interim_B_diff_allcombined <span class="ot">&lt;-</span> <span class="fu">automixfit</span>(interim_diff_map_post[,<span class="st">&quot;theta[4]&quot;</span>])</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_A</span>(interim_A_diff_allcombined)</span></code></pre></div>
<pre><code>## [1] 0.485396</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_B</span>(interim_B_diff_allcombined)</span></code></pre></div>
<pre><code>## [1] 0.6464801</code></pre>
</div>
<div id="pos-for-both-phase-iii-trials-being-successful" class="section level1">
<h1>PoS for both phase III trials being successful</h1>
<p>So far we have only calculated the individual PoS per trial, but more
interesting is the <em>overall</em> PoS for both trials being
successful.</p>
<p>Recall, the PoS is the conditional power integrated over an assumed
true effect distribution. Hence, we had for trial A:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_A</span>(interim_A)</span></code></pre></div>
<pre><code>## [1] 0.4465623</code></pre>
<p>As explained, the conditional power is the operating characerstic of
a design when conditioning on the already observed data:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>interim_oc_A <span class="ot">&lt;-</span> <span class="fu">oc1S</span>(interim_A, Nev<span class="sc">-</span>trials<span class="sc">$</span>deaths[<span class="dv">3</span>], success_crit, <span class="at">sigma=</span><span class="dv">2</span>)</span></code></pre></div>
<p>The PoS is then the integral of the conditional power over the
parameter space <span class="math inline">\(\theta\)</span> representing
our knowledge. This integral can be evaluated in a Monte-Carlo (MC)
approach as</p>
<p><span class="math display">\[ PoS_I = \int CP_{N-n_I}(\theta|y_{n_I})
\, p(\theta|y_{n_I}) \,
d\theta \approx \frac{1}{S} \sum_{i=1}^S CP(\theta_i),\]</span></p>
<p>whenever we have a sample of <span class="math inline">\(p(\theta|y_{n_I})\)</span> of size <span class="math inline">\(S\)</span> which we have:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>interim_A_samp <span class="ot">&lt;-</span> <span class="fu">rmix</span>(interim_A, <span class="fl">1E4</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">interim_oc_A</span>(interim_A_samp))</span></code></pre></div>
<pre><code>## [1] 0.4481538</code></pre>
<p>This is an MC approach to calculating the PoS.</p>
<p>When now considering the probability for both trials being successful
we have to perform an MC integration over the joint density <span class="math inline">\(p(\theta_A,\theta_B|y_{n_{I_A}},y_{n_{I_B}})\)</span></p>
<p><span class="math display">\[
\begin{aligned}
PoS &amp;= \iint CP_{N-n_{I_A}}(\theta_A|y_{n_{I_A}}) \,
CP_{N-n_{I_B}}(\theta_B|y_{n_{I_B}})\,
p(\theta_A,\theta_B|y_{n_{I_A}},y_{n_{I_B}}) \, d\theta_A d\theta_B \\
&amp; \approx
\frac{1}{S} \sum_{i=1}^S CP_{N-n_{I_A}}(\theta_{A,i}|y_{n_{I_A}}) \,
CP_{N-n_{I_B}}(\theta_{B,i}|y_{n_{I_B}}).
\end{aligned}
\]</span></p>
<p>Thus we need to also get the conditional power for trial B at
interim</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>interim_oc_B <span class="ot">&lt;-</span> <span class="fu">oc1S</span>(interim_B, Nev<span class="sc">-</span>trials<span class="sc">$</span>deaths[<span class="dv">4</span>], success_crit, <span class="at">sigma=</span><span class="dv">2</span>)</span></code></pre></div>
<p>and integrate over the posterior samples (differential discounting
case)</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">interim_oc_A</span>(interim_diff_map_post[,<span class="st">&quot;theta[3]&quot;</span>]) <span class="sc">*</span> <span class="fu">interim_oc_B</span>(interim_diff_map_post[,<span class="st">&quot;theta[4]&quot;</span>]))</span></code></pre></div>
<pre><code>## [1] 0.3406513</code></pre>
<p>which is slightly larger than assuming independence:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_A</span>(interim_A) <span class="sc">*</span> <span class="fu">interim_pos_B</span>(interim_B)</span></code></pre></div>
<pre><code>## [1] 0.2863165</code></pre>
<p>This is due to dependence of the posteriors</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(interim_diff_map_post[,<span class="fu">c</span>(<span class="st">&quot;theta[3]&quot;</span>, <span class="st">&quot;theta[4]&quot;</span>)])</span></code></pre></div>
<pre><code>##           theta[3]  theta[4]
## theta[3] 1.0000000 0.2858919
## theta[4] 0.2858919 1.0000000</code></pre>
<p>For the full exchangeability case we have</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">interim_oc_A</span>(interim_map_post[,<span class="st">&quot;theta[3]&quot;</span>]) <span class="sc">*</span> <span class="fu">interim_oc_B</span>(interim_map_post[,<span class="st">&quot;theta[4]&quot;</span>]))</span></code></pre></div>
<pre><code>## [1] 0.3575335</code></pre>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>We have now calculated with increasing complexity the probability of
success for various data constellations. As new trials are only
conducted whenever previous trial results were positive, it is important
to take note of the potential selection bias. Moreover, adding more
historical data sources in this situation will likely increase the
probability of success as illustrated by this summary of our preceding
calculations.</p>
<p>Phase III trial A:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">## only interim data of trial A </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_A</span>(interim_A)</span></code></pre></div>
<pre><code>## [1] 0.4465623</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## in addition with prior historical data PoC &amp; phase II data</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_A</span>(interim_A_combined)</span></code></pre></div>
<pre><code>## [1] 0.4858313</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## finally with the interim data of the phase III B</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_A</span>(interim_A_allcombined)</span></code></pre></div>
<pre><code>## [1] 0.5054541</code></pre>
<p>Phase III trial B:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="do">## only interim data of trial B</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_B</span>(interim_B)</span></code></pre></div>
<pre><code>## [1] 0.6411569</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="do">## in addition with prior historical data PoC &amp; phase II data</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_B</span>(interim_B_combined)</span></code></pre></div>
<pre><code>## [1] 0.669077</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="do">## finally with the interim data of the phase III A</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_B</span>(interim_B_allcombined)</span></code></pre></div>
<pre><code>## [1] 0.6450459</code></pre>
</div>
<div id="appendix-map-and-mac-equivalence" class="section level1">
<h1>Appendix: MAP and MAC equivalence</h1>
<p>In the preceeding sections we have used MAP and MAC equivalence
already. The proof for the equivalence is presented reference in [2].
The formal deriavtion is shown at the end of this section</p>
<p>While MAP and MAC provide the exact same results, the difference is a
sequential vs a joint analysis as (see also [2]):</p>
<ol style="list-style-type: decimal">
<li>MAP: Summarize historical information as MAP and then update the MAP
with the trial result (MCMC, then <code>postmix</code>).</li>
<li>MAC: Directly summarize historical information and trial result in a
single step (only MCMC on all data).</li>
</ol>
<p>The two results above using MAP and MAC did not line up. The reason
here is that the MAP approach used the historical data and the phase III
trial A interim data only. In contrast, the MAC approach used the
historical data and interim phase III data of both trials. To show the
equivalence we need to align this mismatch of used data.</p>
<p>Run <code>gMAP</code> with base data and produce a large MCMC sample
(10 chains) to get a very high precision.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>base_map_mc_2 <span class="ot">&lt;-</span> <span class="fu">gMAP</span>(<span class="fu">cbind</span>(logHR, sem) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> study,</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family=</span>gaussian,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data=</span>base,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">weights=</span>deaths,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tau.dist=</span><span class="st">&quot;HalfNormal&quot;</span>, <span class="at">tau.prior=</span><span class="fl">0.5</span>,</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">beta.prior=</span><span class="fu">cbind</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chains=</span><span class="fu">ifelse</span>(is_CRAN, <span class="dv">2</span>, <span class="dv">20</span>))</span></code></pre></div>
<pre><code>## Warning: There were 1 divergent transitions after warmup. See
## https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
## to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>## Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
<pre><code>## Warning in gMAP(cbind(logHR, sem) ~ 1 | study, family = gaussian, data = base, : In total 1 divergent transitions occured during the sampling phase.
## Please consider increasing adapt_delta closer to 1 with the following command prior to gMAP:
## options(RBesT.MC.control=list(adapt_delta=0.999))</code></pre>
<p>Force an accurate fit with 5 components:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>base_map_2 <span class="ot">&lt;-</span> <span class="fu">mixfit</span>(base_map_mc_2, <span class="at">Nc=</span><span class="dv">5</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>base_map_2</span></code></pre></div>
<pre><code>## EM for Normal Mixture Model
## Log-Likelihood = -15326.7
## 
## Univariate normal mixture
## Reference scale: 2
## Mixture Components:
##   comp1       comp2       comp3       comp4       comp5      
## w  0.42251676  0.20190788  0.18456972  0.13349506  0.05751058
## m -0.26964200  0.09681096 -0.57330711 -0.19149218 -0.94620428
## s  0.23403011  0.40506618  0.31447298  1.14147799  0.47995211</code></pre>
<p>Now, combine the MAP prior (representing historical knowledge) with
the interim data of trial A:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>interim_A_combined_2 <span class="ot">&lt;-</span> <span class="fu">postmix</span>(base_map_2, <span class="at">m=</span>trials<span class="sc">$</span>logHR[<span class="dv">3</span>], <span class="at">se=</span>trials<span class="sc">$</span>sem[<span class="dv">3</span>])</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Run the respective MAC analysis (thus we need historical data +
phase III A trial, but excluding the phase III B data):</li>
</ol>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>interim_map_mc_2 <span class="ot">&lt;-</span> <span class="fu">update</span>(base_map_mc_2, <span class="at">data=</span>trials[<span class="sc">-</span><span class="dv">4</span>,])</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>interim_map_post_2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(interim_map_mc_2)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>turn MCMC posterior sample into parametric mixture</li>
</ol>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>interim_A_allcombined_2 <span class="ot">&lt;-</span> <span class="fu">mixfit</span>(interim_map_post_2[,<span class="st">&quot;theta[3]&quot;</span>], <span class="at">Nc=</span><span class="dv">5</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>interim_A_allcombined_2</span></code></pre></div>
<pre><code>## EM for Normal Mixture Model
## Log-Likelihood = 10820.66
## 
## Univariate normal mixture
## Mixture Components:
##   comp1       comp2       comp3       comp4       comp5      
## w  0.23700022  0.22358582  0.20468017  0.20230931  0.13242449
## m -0.10503056 -0.20723697 -0.30870105 -0.10211462 -0.40044864
## s  0.13409692  0.05498261  0.06261665  0.07807284  0.09148300</code></pre>
<p>Now lets overlay the two posteriors</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">logHR=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.8</span>,<span class="fl">0.25</span>)), <span class="fu">aes</span>(logHR)) <span class="sc">+</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun=</span>dmix, <span class="at">args=</span><span class="fu">list</span>(<span class="at">mix=</span>interim_A_combined_2), <span class="fu">aes</span>(<span class="at">linetype=</span><span class="st">&quot;MAP&quot;</span>)) <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun=</span>dmix, <span class="at">args=</span><span class="fu">list</span>(<span class="at">mix=</span>interim_A_allcombined_2), <span class="fu">aes</span>(<span class="at">linetype=</span><span class="st">&quot;MAC&quot;</span>)) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_discrete</span>(<span class="st">&quot;Analysis&quot;</span>) <span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Posterior log hazard of phase III A trial at interim&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" style="display: block; margin: auto;" /></p>
<p>The PoS is essentially the same</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_A</span>(interim_A_combined_2)</span></code></pre></div>
<pre><code>## [1] 0.4898467</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interim_pos_A</span>(interim_A_allcombined_2)</span></code></pre></div>
<pre><code>## [1] 0.4913528</code></pre>
<div id="formal-map-and-mac-equivalence" class="section level2">
<h2>Formal MAP and MAC equivalence</h2>
<p>The stated equivalence requires that the posterior of a trial
specific parameter</p>
<p><span class="math display">\[p(\theta_\star|y_\star,y_H),\]</span></p>
<p>which is conditional on the trial specific data <span class="math inline">\(y_\star\)</span> <strong>and</strong> the
historical data <span class="math inline">\(y_H\)</span> (MAC approach,
joint use of <span class="math inline">\(y_H,y_\star\)</span>), is
equivalent to obtaining the MAP prior <span class="math inline">\(p(\theta_\star|y_H)\)</span> based on the
historical data and then analyzing the new trial with this prior.</p>
<p><span class="math display">\[
\begin{aligned}
p(\theta_\star|y_\star,y_H) &amp;\propto
p(\theta_\star,\theta_H|y_\star,y_H) \\
&amp;\propto p(y_\star,y_H|\theta_\star,\theta_H) \,
p(\theta_\star,\theta_H) \\
&amp;= p(y_\star|\theta_\star) \, p(y_H|\theta_H) \,
p(\theta_\star,\theta_H) \\
&amp;\propto p(y_\star|\theta_\star) \, p(\theta_\star,\theta_H|y_H) \\
&amp;\propto p(y_\star|\theta_\star) \, p(\theta_\star|y_H)
\end{aligned}
\]</span></p>
<p>The equivalence holds under the use of the meta-analytic model.</p>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>[1] Neuenschwander, B., Roychoudhury, S., &amp; Schmidli, H. (2016).
On the Use of Co-Data in Clinical Trials. Statistics in
Biopharmaceutical Research, 8(3), 345-354. </p>
<p>[2] 1. Schmidli H, Gsteiger S, Roychoudhury S, OHagan A,
Spiegelhalter D, Neuenschwander B. Robust meta-analytic-predictive
priors in clinical trials with historical control information.
Biometrics. 2014;70(4):1023-1032. </p>
</div>
<div id="r-session-info" class="section level1">
<h1>R Session Info</h1>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.1.0 (2021-05-18)
## Platform: aarch64-apple-darwin20 (64-bit)
## Running under: macOS 13.5
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] purrr_0.3.5      bayesplot_1.10.0 tidyr_1.2.1      dplyr_1.0.10    
## [5] ggplot2_3.4.2    knitr_1.40       RBesT_1.7-1     
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.9           mvtnorm_1.1-3        prettyunits_1.1.1   
##  [4] ps_1.7.1             assertthat_0.2.1     digest_0.6.30       
##  [7] utf8_1.2.2           plyr_1.8.7           R6_2.5.1            
## [10] backports_1.4.1      stats4_4.1.0         evaluate_0.17       
## [13] highr_0.9            pillar_1.8.1         rlang_1.1.1         
## [16] callr_3.7.3          jquerylib_0.1.4      checkmate_2.1.0     
## [19] rmarkdown_2.20       labeling_0.4.2       textshaping_0.3.6   
## [22] stringr_1.4.1        loo_2.5.1            munsell_0.5.0       
## [25] compiler_4.1.0       xfun_0.37            rstan_2.21.7        
## [28] pkgconfig_2.0.3      systemfonts_1.0.4    pkgbuild_1.3.1      
## [31] rstantools_2.3.1     htmltools_0.5.3      tidyselect_1.2.0    
## [34] tensorA_0.36.2       tibble_3.1.8         gridExtra_2.3       
## [37] codetools_0.2-18     matrixStats_0.62.0   fansi_1.0.3         
## [40] crayon_1.5.2         withr_2.5.0          distributional_0.3.2
## [43] grid_4.1.0           jsonlite_1.8.3       gtable_0.3.1        
## [46] lifecycle_1.0.3      DBI_1.1.3            posterior_1.4.1     
## [49] magrittr_2.0.3       StanHeaders_2.21.0-7 scales_1.2.1        
## [52] RcppParallel_5.1.5   cli_3.4.1            stringi_1.7.8       
## [55] cachem_1.0.6         reshape2_1.4.4       farver_2.1.1        
## [58] bslib_0.4.0          ellipsis_0.3.2       ragg_1.2.1          
## [61] generics_0.1.3       vctrs_0.5.0          Formula_1.2-4       
## [64] tools_4.1.0          glue_1.6.2           processx_3.7.0      
## [67] abind_1.4-5          parallel_4.1.0       fastmap_1.1.0       
## [70] yaml_2.3.6           inline_0.3.19        colorspace_2.0-3    
## [73] sass_0.4.2</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
